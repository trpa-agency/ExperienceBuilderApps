System.register(["jimu-core","jimu-ui/advanced/setting-components","jimu-ui","jimu-ui/advanced/resource-selector","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder"],(function(e,t){var i={},s={},o={},a={},n={},p={};return{setters:[function(e){i.CONSTANTS=e.CONSTANTS,i.DataSourceComponent=e.DataSourceComponent,i.DataSourceManager=e.DataSourceManager,i.ImageDisplayQualityMode=e.ImageDisplayQualityMode,i.Immutable=e.Immutable,i.React=e.React,i.classNames=e.classNames,i.css=e.css,i.expressionUtils=e.expressionUtils,i.jsx=e.jsx},function(e){s.LinkSelector=e.LinkSelector,s.SettingRow=e.SettingRow,s.SettingSection=e.SettingSection},function(e){o.Button=e.Button,o.Icon=e.Icon,o.ImageFillMode=e.ImageFillMode,o.Label=e.Label,o.NumericInput=e.NumericInput,o.Radio=e.Radio,o.Select=e.Select,o.Slider=e.Slider,o.Tab=e.Tab,o.Tabs=e.Tabs,o.TextInput=e.TextInput,o.Tooltip=e.Tooltip,o.imageUtils=e.imageUtils},function(e){a.ImageSelector=e.ImageSelector},function(e){n.AllDataSourceTypes=e.AllDataSourceTypes,n.DataSourceSelector=e.DataSourceSelector,n.DataViewPriority=e.DataViewPriority,n.MainDataAndViewSelector=e.MainDataAndViewSelector},function(e){p.ExpressionInput=e.ExpressionInput,p.ExpressionInputType=e.ExpressionInputType}],execute:function(){e((()=>{var e={24359:(e,t,i)=>{var s={"./chart-area.svg":23659,"./chart-pie.svg":74958,"./chart.svg":93108,"./circle-double.svg":74874,"./circle.svg":53720,"./data-source.svg":76637,"./data.svg":97197,"./ellipse.svg":33802,"./grid.svg":45531,"./hexagon.svg":97709,"./image.svg":41210,"./layer.svg":63980,"./list.svg":30512,"./page.svg":19672,"./pentagon.svg":36927,"./pill.svg":24555,"./rectangle.svg":64986,"./rhombus.svg":2761,"./ring.svg":29704,"./square-border-rounded.svg":67660,"./square.svg":72180,"./triangle.svg":61403,"./widget.svg":50687};function o(e){var t=a(e);return i(t)}function a(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}o.keys=function(){return Object.keys(s)},o.resolve=a,e.exports=o,o.id=24359},23659:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 4.97V14H15v1H2a1 1 0 01-1-1V1h1v11.5l2.645-5a1 1 0 011.16-.47 1 1 0 01.39.225L8.1 9.524a.5.5 0 00.78-.017l3.724-4.842a.5.5 0 01.896.305z" fill="#000"></path></svg>'},74958:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.53 12.282A7.014 7.014 0 0015 7.972C15 4.39 12.328 1.433 8.875 1v6.609l4.655 4.673zm-1.238 1.242A6.952 6.952 0 018 15c-3.866 0-7-3.146-7-7.027C1 4.39 3.672 1.433 7.125 1v7.337l5.167 5.187z" fill="#000"></path></svg>'},93108:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.286 0h3.428v16H6.286V0zm6.285 4.571H16V16h-3.429V4.571zM3.43 9.143H0V16h3.429V9.143z" fill="#000"></path></svg>'},74874:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14 8A6 6 0 112 8a6 6 0 0112 0zm1 0A7 7 0 111 8a7 7 0 0114 0zm-7 4a4 4 0 100-8 4 4 0 000 8z" fill="#000"></path></svg>'},53720:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0z" fill="#000"></path></svg>'},76637:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.8 0a2 2 0 00-2 2v2h14.4V2a2 2 0 00-2-2H2.8zm12.4 5.6H.8v4.8h14.4V5.6zM.8 12h14.4v2a2 2 0 01-2 2H2.8a2 2 0 01-2-2v-2zm4-10a1.2 1.2 0 11-2.4 0 1.2 1.2 0 012.4 0zm0 6a1.2 1.2 0 11-2.4 0 1.2 1.2 0 012.4 0zm-1.2 7.2a1.2 1.2 0 100-2.4 1.2 1.2 0 000 2.4z" fill="#000"></path></svg>'},97197:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0c3.534 0 6.4 1.075 6.4 2.4v2.4c0 1.325-2.865 2.4-6.4 2.4S1.6 6.125 1.6 4.8V2.427a.92.92 0 010-.027C1.6 1.075 4.465 0 8 0zM1.6 6.774a.92.92 0 000 .053v2.374c0 1.325 2.866 2.4 6.4 2.4 3.535 0 6.4-1.075 6.4-2.4V6.8c0 1.325-2.865 2.4-6.4 2.4-3.534 0-6.4-1.075-6.4-2.4v-.027zm0 4.4a.914.914 0 000 .053V13.6C1.6 14.925 4.467 16 8 16c3.535 0 6.4-1.075 6.4-2.4v-2.4c0 1.325-2.865 2.4-6.4 2.4-3.534 0-6.4-1.075-6.4-2.4v-.027z" fill="#000"></path></svg>'},33802:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 8c0 3.314-3.582 6-8 6s-8-2.686-8-6 3.582-6 8-6 8 2.686 8 6z" fill="#000"></path></svg>'},45531:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 1h3v3H1V1zm5.5 0h3v3h-3V1zM15 1h-3v3h3V1zM1 6.5h3v3H1v-3zm8.5 0h-3v3h3v-3zm2.5 0h3v3h-3v-3zM4 12H1v3h3v-3zm2.5 0h3v3h-3v-3zm8.5 0h-3v3h3v-3z" fill="#000"></path></svg>'},97709:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0l6.929 4v8L8 16l-6.928-4V4L8 0z" fill="#000"></path></svg>'},41210:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.728 8.981L10.286 4 16 12H0l4.571-5.714L6.728 8.98z" fill="#000"></path></svg>'},63980:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.629 9.143L16 10.286 8 16l-8-5.714 1.371-1.143L8 13.714l6.629-4.571zM8 0l8 5.714-8 5.715-8-5.715L8 0z" fill="#000"></path></svg>'},30512:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 2H1v2h2V2zm0 5H1v2h2V7zm-2 5h2v2H1v-2zM15 2H5v2h10V2zM5 7h10v2H5V7zm10 5H5v2h10v-2z" fill="#000"></path></svg>'},19672:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4 14.4a1.6 1.6 0 01-1.6 1.6H3.2a1.6 1.6 0 01-1.6-1.6V1.6A1.6 1.6 0 013.2 0h4.6a1 1 0 011 1v3.6a1 1 0 001 1h3.6a1 1 0 011 1v7.8zM10.4 0v3a1 1 0 001 1h3l-4-4zm-4 8H12v1.6H6.4V8zm0 3.2H12v1.6H6.4v-1.6zm-.8.8A.8.8 0 114 12a.8.8 0 011.6 0zm-.8-2.4a.8.8 0 100-1.6.8.8 0 000 1.6z" fill="#000"></path></svg>'},36927:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0l7.608 5.528-2.906 8.944H3.298L.392 5.528 8 0z" fill="#000"></path></svg>'},24555:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="1" y="4" width="14" height="8" rx="4" fill="#000"></rect></svg>'},64986:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 2h16v12H0V2z" fill="#000"></path></svg>'},2761:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0l8 8-8 8-8-8 8-8z" fill="#000"></path></svg>'},29704:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="8" cy="8" r="6" stroke="#000" stroke-width="2"></circle></svg>'},67660:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14 2H2v12h12V2zM2 0a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2H2z" fill="#000"></path></svg>'},72180:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h16v16H0V0z" fill="#000"></path></svg>'},61403:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1l8 14H0L8 1z" fill="#000"></path></svg>'},50687:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.667 4.667L11.333 0 16 4.667l-4.667 4.666-4.666-4.666zM0 1.333V8h6.667V1.333H0zM6.667 16H0V9.333h6.667V16zM8 16V9.333h6.667V16H8z" fill="#000"></path></svg>'},84762:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjIwcHgiIGhlaWdodD0iMjBweCIgdmlld0JveD0iMCAwIDIwIDIwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNCAoNjczNzgpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPg0KICAgIDx0aXRsZT5SZWN0YW5nbGU8L3RpdGxlPg0KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPg0KICAgIDxnIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjUuMDAwMDAwLCAtNjQ1LjAwMDAwMCkiIGZpbGwtcnVsZT0ibm9uemVybyIgc3Ryb2tlPSIjRTZFQkYwIj4NCiAgICAgICAgICAgIDxnPg0KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwLjAwMDAwMCwgNjExLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMjkuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCB4PSI0NS41IiB5PSI1LjUiIHdpZHRoPSIxOSIgaGVpZ2h0PSIxOSIgcng9IjYiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICAgICAgPC9nPg0KICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgIDwvZz4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg=="},20988:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjIycHgiIGhlaWdodD0iMThweCIgdmlld0JveD0iMCAwIDIyIDE4IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNCAoNjczNzgpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPg0KICAgIDx0aXRsZT5PdmFsPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZyBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEwNC4wMDAwMDAsIC02NDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIiBzdHJva2U9IiNFNkVCRjAiPg0KICAgICAgICAgICAgPGc+DQogICAgICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAuMDAwMDAwLCA2MTEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAyOS4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxlbGxpcHNlIGN4PSI5NSIgY3k9IjE1IiByeD0iMTAiIHJ5PSI4Ij48L2VsbGlwc2U+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},42032:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjIwcHgiIGhlaWdodD0iMTRweCIgdmlld0JveD0iMCAwIDIwIDE0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNCAoNjczNzgpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPg0KICAgIDx0aXRsZT5SZWN0YW5nbGU8L3RpdGxlPg0KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPg0KICAgIDxnIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjUuMDAwMDAwLCAtNjQ4LjAwMDAwMCkiIGZpbGwtcnVsZT0ibm9uemVybyIgc3Ryb2tlPSIjRTZFQkYwIj4NCiAgICAgICAgICAgIDxnPg0KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwLjAwMDAwMCwgNjExLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMjkuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCB4PSI1LjUiIHk9IjguNSIgd2lkdGg9IjE5IiBoZWlnaHQ9IjEzIj48L3JlY3Q+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},48891:e=>{"use strict";e.exports=i},30726:e=>{"use strict";e.exports=o},338:e=>{"use strict";e.exports=n},39342:e=>{"use strict";e.exports=p},20663:e=>{"use strict";e.exports=a},77756:e=>{"use strict";e.exports=s}},t={};function r(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var l={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(l),r.d(l,{default:()=>S});var e,t,i=r(48891),s=r(77756),o=r(30726),a=r(20663),n=r(338);!function(e){e.ByUpload="BYUPLOAD",e.ByStaticUrl="BYSTATICURL",e.ByDynamicUrl="BYDYNAMICURL"}(e||(e={})),function(e){e.Expression="EXPRESSION",e.Attachment="ATTACHMENT",e.Symbol="SYMBOL"}(t||(t={}));const p={shapes:{square:{borderRadius:{number:[0],unit:"px"},thumbUrl:r(42032)},capsule:{borderRadius:{number:[10,10,10,10],unit:"%"},thumbUrl:r(84762)},round:{borderRadius:{number:[50,50,50,50],unit:"%"},thumbUrl:r(20988)}}},c={imageSource:"Image source",imageNoneSource:"None",staticSource:"Static",dynamicSource:"Dynamic",imageSet:"Select an image",toolTip:"Tooltip",altText:"Alt text",imageSetLink:"Set link",imageShape:"Shape",imagePosition:"Position",imageFit:"Fit",imageFill:"Fill",imageAttachment:"Attachment",imageCustom:"Custom",imageAttachmentName:"Attachment name",imageSymbol:"Symbol",imageSymbolScale:"Symbol scale",imagerectangle:"Rectangle/Square",imagecircle:"Oval/Circle",imagehexagon:"Hexagon",imagepentagon:"Pentagon",imagerhombus:"Rhombus",imagetriangle:"Triangle",imageShapeSettings:"Shape settings",imageUploadBlankStatus:'Click the "{ButtonString}" button to select an image from your device.',imageDisplayQuality:"Image display quality",displayQualityTooltipWithLow:"Low",displayQualityTooltipWithMedium:"Medium",displayQualityTooltipWithHigh:"High",displayQualityTooltipWithOriginal:"Original"};class g extends i.React.PureComponent{constructor(){super(...arguments),this.cropShapeList=["square","circle","hexagon","pentagon","rhombus","triangle"],this.shapeClick=(e,t)=>{if(this.props.cropParam&&this.props.cropParam.cropShape===this.cropShapeList[t])return;const s=e.currentTarget.getElementsByTagName("svg")&&e.currentTarget.getElementsByTagName("svg")[0];if(s){let e=this.props.cropParam;e||(e=(0,i.Immutable)({})),e=e.set("svgViewBox",s.getAttribute("viewBox")),e=e.set("svgPath",s.getElementsByTagName("path")[0].getAttribute("d")),e=e.set("cropShape",this.cropShapeList[t]),this.props.onShapeChoosed&&this.props.onShapeChoosed(e)}}}getStyle(){const e=this.props.theme;return i.css`
      .widget-image-chooseshape-item {
        cursor: pointer;
        height: 30px;
        width: 35px;
        background-color: ${e.colors.palette.secondary[200]};

        svg {
          fill: ${e.colors.black};
        }
      }
      `}render(){return(0,i.jsx)("div",{className:"w-100 d-flex justify-content-between",css:this.getStyle()},this.cropShapeList.map(((e,t)=>{var s,a;const n=r(24359)(`./${e}.svg`);if("square"!==e||this.props.cropParam){const p="square"===e?"imagerectangle":`image${e}`,r=(null===(a=null===(s=this.props)||void 0===s?void 0:s.cropParam)||void 0===a?void 0:a.cropShape)===e;return(0,i.jsx)(o.Button,{key:t,className:(0,i.classNames)("widget-image-chooseshape-item p-0",{"border-selected":r}),onClick:e=>this.shapeClick(e,t),icon:!0,title:this.props.intl.formatMessage({id:p,defaultMessage:c[p]}),"aria-pressed":r},(0,i.jsx)(o.Icon,{width:12,height:12,icon:n}))}return(0,i.jsx)(o.Button,{key:t,className:(0,i.classNames)("widget-image-chooseshape-item border-selected p-0"),onClick:e=>this.shapeClick(e,t),icon:!0,title:this.props.intl.formatMessage({id:"imagerectangle",defaultMessage:c.imagerectangle}),"aria-pressed":!0},(0,i.jsx)(o.Icon,{width:12,height:12,icon:n}))})))}}var h=r(39342);const u=(0,i.Immutable)([h.ExpressionInputType.Static,h.ExpressionInputType.Attribute,h.ExpressionInputType.Statistics,h.ExpressionInputType.Expression]);class m extends i.React.PureComponent{constructor(){super(...arguments),this.getRenderContent=a=>this.props.useDataSourcesEnabled?this.props.imgSourceType!==e.ByDynamicUrl||this.props.dynamicUrlType!==t.Attachment&&this.props.dynamicUrlType!==t.Symbol?i.React.createElement("div",{style:{width:"100%",position:"relative"},role:"group","aria-label":a},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onToolTipExpChange,openExpPopup:this.props.openToolTipPopup,expression:this.props.toolTipExpression,isExpPopupOpen:this.props.isToolTipPopupOpen,closeExpPopup:this.props.closeToolTipPopup,types:u,widgetId:this.props.widgetId})):this.props.dynamicUrlType===t.Attachment?i.React.createElement("div",{className:"w-100"},i.React.createElement(s.SettingRow,{flow:"wrap"},i.React.createElement("div",{className:"align-items-center d-flex"},i.React.createElement(o.Radio,{style:{cursor:"pointer"},onChange:()=>this.props.onToolTipWithAttachmentNameChange(!1),checked:!this.props.toolTipWithAttachmentName}),i.React.createElement("label",{className:"m-0 ml-2",style:{cursor:"pointer"},onClick:()=>this.props.onToolTipWithAttachmentNameChange(!1)},this.props.intl.formatMessage({id:"imageCustom",defaultMessage:c.imageCustom})))),!this.props.toolTipWithAttachmentName&&i.React.createElement(s.SettingRow,null,i.React.createElement("div",{className:"w-100 d-flex justify-content-end"},i.React.createElement("div",{style:{width:"90%",position:"relative"}},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onToolTipExpChange,openExpPopup:this.props.openToolTipPopup,expression:this.props.toolTipExpression,isExpPopupOpen:this.props.isToolTipPopupOpen,closeExpPopup:this.props.closeToolTipPopup,types:u,widgetId:this.props.widgetId})))),i.React.createElement(s.SettingRow,null,i.React.createElement("div",{className:"align-items-center d-flex"},i.React.createElement(o.Radio,{style:{cursor:"pointer"},onChange:()=>this.props.onToolTipWithAttachmentNameChange(!0),checked:this.props.toolTipWithAttachmentName}),i.React.createElement("label",{className:"m-0 ml-2",style:{cursor:"pointer"},onClick:()=>this.props.onToolTipWithAttachmentNameChange(!0)},this.props.intl.formatMessage({id:"imageAttachmentName",defaultMessage:c.imageAttachmentName}))))):this.props.dynamicUrlType===t.Symbol?i.React.createElement("div",{style:{width:"100%",position:"relative"},role:"group","aria-label":a},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onToolTipExpChange,openExpPopup:this.props.openToolTipPopup,expression:this.props.toolTipExpression,isExpPopupOpen:this.props.isToolTipPopupOpen,closeExpPopup:this.props.closeToolTipPopup,types:u,widgetId:this.props.widgetId})):void 0:i.React.createElement("div",{style:{width:"100%",position:"relative"}},i.React.createElement(o.TextInput,{size:"sm",style:{width:"100%"},className:"float-right",value:this.props.toolTipText,onChange:e=>{this.props.onToolTipTextInputChange(e.target.value)},onBlur:()=>{this.props.toolTipConfigChange()},onKeyUp:()=>{this.props.toolTipConfigChange()},"aria-label":a}))}render(){const e=this.props.intl.formatMessage({id:"toolTip",defaultMessage:c.toolTip});return i.React.createElement(s.SettingRow,{flow:"wrap",label:e},this.getRenderContent(e))}}const d=(0,i.Immutable)([h.ExpressionInputType.Static,h.ExpressionInputType.Attribute,h.ExpressionInputType.Statistics,h.ExpressionInputType.Expression]);class f extends i.React.PureComponent{constructor(){super(...arguments),this.getRenderContent=a=>this.props.useDataSourcesEnabled?this.props.imgSourceType!==e.ByDynamicUrl||this.props.dynamicUrlType!==t.Attachment&&this.props.dynamicUrlType!==t.Symbol?i.React.createElement("div",{style:{width:"100%",position:"relative"},role:"group","aria-label":a},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onAltTextExpChange,openExpPopup:this.props.openAltTextPopup,expression:this.props.altTextExpression,isExpPopupOpen:this.props.isAltTextPopupOpen,closeExpPopup:this.props.closeAltTextPopup,types:d,widgetId:this.props.widgetId})):this.props.dynamicUrlType===t.Attachment?i.React.createElement("div",{className:"w-100"},i.React.createElement(s.SettingRow,{flow:"wrap"},i.React.createElement("div",{className:"align-items-center d-flex"},i.React.createElement(o.Radio,{style:{cursor:"pointer"},onChange:()=>this.props.onAltTextWithAttachmentNameChange(!1),checked:!this.props.altTextWithAttachmentName}),i.React.createElement("label",{className:"m-0 ml-2",style:{cursor:"pointer"},onClick:()=>this.props.onAltTextWithAttachmentNameChange(!1)},this.props.intl.formatMessage({id:"imageCustom",defaultMessage:c.imageCustom})))),!this.props.altTextWithAttachmentName&&i.React.createElement(s.SettingRow,null,i.React.createElement("div",{className:"w-100 d-flex justify-content-end"},i.React.createElement("div",{style:{width:"90%",position:"relative"}},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onAltTextExpChange,openExpPopup:this.props.openAltTextPopup,expression:this.props.altTextExpression,isExpPopupOpen:this.props.isAltTextPopupOpen,closeExpPopup:this.props.closeAltTextPopup,types:d,widgetId:this.props.widgetId})))),i.React.createElement(s.SettingRow,null,i.React.createElement("div",{className:"align-items-center d-flex"},i.React.createElement(o.Radio,{style:{cursor:"pointer"},onChange:()=>this.props.onAltTextWithAttachmentNameChange(!0),checked:this.props.altTextWithAttachmentName}),i.React.createElement("label",{className:"m-0 ml-2",style:{cursor:"pointer"},onClick:()=>this.props.onAltTextWithAttachmentNameChange(!0)},this.props.intl.formatMessage({id:"imageAttachmentName",defaultMessage:c.imageAttachmentName}))))):this.props.dynamicUrlType===t.Symbol?i.React.createElement("div",{style:{width:"100%",position:"relative"},role:"group","aria-label":a},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onAltTextExpChange,openExpPopup:this.props.openAltTextPopup,expression:this.props.altTextExpression,isExpPopupOpen:this.props.isAltTextPopupOpen,closeExpPopup:this.props.closeAltTextPopup,types:d,widgetId:this.props.widgetId})):void 0:i.React.createElement("div",{style:{width:"100%",position:"relative"}},i.React.createElement(o.TextInput,{size:"sm",style:{width:"100%"},className:"float-right",value:this.props.altTextText,onChange:e=>{this.props.onAltTextTextInputChange(e.target.value)},onBlur:()=>{this.props.altTextConfigChange()},onKeyUp:()=>{this.props.altTextConfigChange()},"aria-label":a}))}render(){const e=this.props.intl.formatMessage({id:"altText",defaultMessage:c.altText});return i.React.createElement(s.SettingRow,{flow:"wrap",label:e},this.getRenderContent(e))}}const C=(0,i.Immutable)([h.ExpressionInputType.Attribute,h.ExpressionInputType.Expression]);class x extends i.React.PureComponent{constructor(){super(...arguments),this.getRenderContent=e=>{const a=e&&e.supportAttachment(),p=e&&e.supportSymbol();return e?((!a&&this.props.dynamicUrlType===t.Attachment||!p&&this.props.dynamicUrlType===t.Symbol)&&this.props.onTypeNoSupportChange&&this.props.onTypeNoSupportChange(),p||a?i.React.createElement("div",{className:"w-100"},this.getExpressionSettingWithRadio(),a&&i.React.createElement("div",{className:"w-100 d-flex justify-content-end mt-3","data-testid":"dynamicurl-attachment"},i.React.createElement("div",{className:"w-100"},i.React.createElement(s.SettingRow,{flow:"wrap"},i.React.createElement("div",{className:"d-flex justify-content-between w-100"},i.React.createElement("div",{className:"align-items-center d-flex"},i.React.createElement(o.Label,{className:"d-flex align-items-center m-0"},i.React.createElement(o.Radio,{style:{cursor:"pointer"},onChange:()=>this.props.onDynamicUrlTypeChanged(t.Attachment),checked:this.props.dynamicUrlType===t.Attachment}),i.React.createElement("div",{className:"ml-2"},this.props.intl.formatMessage({id:"imageAttachment",defaultMessage:c.imageAttachment}))))),this.props.dynamicUrlType===t.Attachment&&i.React.createElement("div",{className:"d-flex w-100 justify-content-end mt-3"},i.React.createElement("div",{style:{width:"90%",position:"relative"}},i.React.createElement(n.MainDataAndViewSelector,{hideMainDataSourceSelect:!0,widgetId:this.props.widgetId,useDataSources:this.props.useDataSources,selectedUseDataSource:this.props.useDataSourceForMainDataAndViewSelector,onChange:this.props.onSelectedUseDsChangeForAttachment,isSelectedFromRepeatedDataSourceContext:this.props.isSelectedFromRepeatedDataSourceContext,usePopulatedDataView:!0,useSelectionDataView:!0,defaultDataViewPriority:n.DataViewPriority.First})))))),p&&i.React.createElement("div",{className:"w-100 d-flex justify-content-end mt-3"},i.React.createElement("div",{className:"w-100"},i.React.createElement(s.SettingRow,{flow:"wrap"},i.React.createElement("div",{className:"d-flex justify-content-between w-100"},i.React.createElement("div",{className:"align-items-center d-flex"},i.React.createElement(o.Label,{className:"d-flex align-items-center m-0"},i.React.createElement(o.Radio,{style:{cursor:"pointer"},onChange:()=>this.props.onDynamicUrlTypeChanged(t.Symbol),checked:this.props.dynamicUrlType===t.Symbol}),i.React.createElement("div",{className:"ml-2"},this.props.intl.formatMessage({id:"imageSymbol",defaultMessage:c.imageSymbol}))))),this.props.dynamicUrlType===t.Symbol&&i.React.createElement("div",{className:"d-flex w-100 justify-content-end mt-3"},i.React.createElement("div",{style:{width:"90%",position:"relative"}},i.React.createElement(n.MainDataAndViewSelector,{hideMainDataSourceSelect:!0,widgetId:this.props.widgetId,useDataSources:this.props.useDataSources,selectedUseDataSource:this.props.useDataSourceForMainDataAndViewSelector,isSelectedFromRepeatedDataSourceContext:this.props.isSelectedFromRepeatedDataSourceContext,onChange:this.props.onSelectedUseDsChangeForSymbol,usePopulatedDataView:!0,useSelectionDataView:!0,defaultDataViewPriority:n.DataViewPriority.First}))))))):this.getExpressionSettingWithoutRadio()):this.getExpressionSettingWithoutRadio()},this.getExpressionSettingWithRadio=()=>i.React.createElement("div",{className:"w-100 d-flex justify-content-end"},i.React.createElement("div",{className:"w-100"},i.React.createElement("div",{className:"d-flex w-100 align-items-center"},i.React.createElement(o.Label,{className:"d-flex align-items-center m-0"},i.React.createElement(o.Radio,{style:{cursor:"pointer"},onChange:()=>this.props.onDynamicUrlTypeChanged(t.Expression),checked:this.props.dynamicUrlType===t.Expression||!this.props.dynamicUrlType,"data-testid":"dynamicurl-expression"}),i.React.createElement("div",{className:"ml-2"},"URL"))),(this.props.srcExpression||this.props.dynamicUrlType===t.Expression||!this.props.dynamicUrlType)&&i.React.createElement("div",{className:"d-flex w-100 justify-content-end mt-3"},i.React.createElement("div",{style:{width:"90%",position:"relative"}},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onSrcExpChange,openExpPopup:this.props.openSrcPopup,expression:this.props.srcExpression,isExpPopupOpen:this.props.isSrcPopupOpen,closeExpPopup:this.props.closeSrcPopup,types:C,widgetId:this.props.widgetId}))))),this.getExpressionSettingWithoutRadio=()=>i.React.createElement("div",{className:"w-100 d-flex justify-content-end"},i.React.createElement("div",{className:"w-100"},i.React.createElement("div",{className:"d-flex justify-content-between w-100 align-items-center"},i.React.createElement("label",{className:"m-0"},"URL")),this.props.srcExpression||this.props.dynamicUrlType===t.Expression||!this.props.dynamicUrlType?i.React.createElement("div",{className:"mt-2",style:{width:"100%",position:"relative"}},i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onSrcExpChange,openExpPopup:this.props.openSrcPopup,expression:this.props.srcExpression,isExpPopupOpen:this.props.isSrcPopupOpen,closeExpPopup:this.props.closeSrcPopup,types:C,widgetId:this.props.widgetId})):i.React.createElement("div",{className:"mt-2",style:{width:"100%",position:"relative"}},i.React.createElement("div",{className:"w-100 h-100",style:{position:"absolute",opacity:.5,backgroundColor:"gray",zIndex:100}}),i.React.createElement(h.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.props.onSrcExpChange,openExpPopup:this.props.openSrcPopup,expression:this.props.srcExpression,isExpPopupOpen:this.props.isSrcPopupOpen,closeExpPopup:this.props.closeSrcPopup,types:C,widgetId:this.props.widgetId}))))}render(){let e=null;if(this.props.useDataSources)for(let t=0;t<this.props.useDataSources.length;t++)e=this.props.useDataSources[0];return i.React.createElement(s.SettingRow,{flow:"wrap"},e&&i.React.createElement(i.DataSourceComponent,{useDataSource:e},(e=>this.getRenderContent(e))),!e&&this.getExpressionSettingWithoutRadio())}}class S extends i.React.PureComponent{constructor(t){super(t),this.supportedTypes=(0,i.Immutable)([n.AllDataSourceTypes.FeatureLayer,n.AllDataSourceTypes.SceneLayer]),this.onSymbolScaleChanged=null,this.minSymbolScale=.5,this.maxSymbolScale=5,this.SymbolScaleStep=.1,this.linkSettingTrigger=i.React.createRef(),this.displayQualityTrigger=i.React.createRef(),this.formatMessage=(e,t)=>{const i=Object.assign({},c);return this.props.intl.formatMessage({id:e,defaultMessage:i[e]},t)},this.settingLinkConfirm=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","linkParam"],e)})},this.updateStyle=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["styleConfig",e],t)})},this.shapeChange=e=>{let t=(0,i.Immutable)(this.props.config.styleConfig);t=t.set("shape",e),t=t.set("borderRadius",this.props.preDefinedConfigs.shapes[e].borderRadius),this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["styleConfig"],t)})},this.altTextConfigChange=()=>{const e={id:this.props.id,config:this.props.config.setIn(["functionConfig","altText"],this.state.currentAltTextInput).setIn(["functionConfig","altTextExpression"],null),useDataSources:this.getUseDataSourcesWithoutFields()};this.props.onSettingChange(e)},this.toolTipConfigChange=()=>{const e={id:this.props.id,config:this.props.config.setIn(["functionConfig","toolTip"],this.state.currentTipInput).setIn(["functionConfig","toolTipExpression"],null),useDataSources:this.getUseDataSourcesWithoutFields()};this.props.onSettingChange(e)},this.imgSourceTypeChanged=e=>{let t=(0,i.Immutable)(this.props.config.functionConfig);t=t.set("dynamicUrlType",null),t=t.set("imgSourceType",e),t=t.set("srcExpression",null),t=t.set("imageParam",this.resetImageParam(this.props.config.functionConfig.imageParam)),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("functionConfig",t)})},this.dynamicUrlTypeChanged=t=>{let s=(0,i.Immutable)(this.props.config.functionConfig);s=s.set("dynamicUrlType",t),s=s.set("imgSourceType",e.ByDynamicUrl),s=s.set("srcExpression",null),s=s.set("imageParam",this.resetImageParam(this.props.config.functionConfig.imageParam)),s=s.set("altTextWithAttachmentName",null),s=s.set("toolTipWithAttachmentName",null),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("functionConfig",s)})},this.openSrcPopup=()=>{this.setState({isSrcPopupOpen:!0,isAltTextPopupOpen:!1,isToolTipPopupOpen:!1})},this.closeSrcPopup=()=>{this.setState({isSrcPopupOpen:!1})},this.openToolTipPopup=()=>{this.setState({isSrcPopupOpen:!1,isAltTextPopupOpen:!1,isToolTipPopupOpen:!0})},this.closeToolTipPopup=()=>{this.setState({isToolTipPopupOpen:!1})},this.openAltTextPopup=()=>{this.setState({isSrcPopupOpen:!1,isAltTextPopupOpen:!0,isToolTipPopupOpen:!1})},this.closeAltTextPopup=()=>{this.setState({isAltTextPopupOpen:!1})},this.getUseDataSourcesWithoutFields=()=>this.props.useDataSources&&this.props.useDataSources[0]&&this.props.useDataSources[0].dataSourceId?[this.props.useDataSources[0].without("fields")]:[],this.getSrcExpression=()=>{const e=this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.srcExpression&&this.props.config.functionConfig.srcExpression;return e&&e.asMutable({deep:!0})||null},this.getToolTipExpression=()=>{const e=this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTipExpression&&this.props.config.functionConfig.toolTipExpression;return e&&e.asMutable({deep:!0})||null},this.getAltTextExpression=()=>{const e=this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.altTextExpression&&this.props.config.functionConfig.altTextExpression;return e&&e.asMutable({deep:!0})||null},this.onToolTipExpChange=e=>{if(!e)return;const t=this.getSrcExpression(),i=this.getAltTextExpression(),s=this.mergeUseDataSources(t,e,i);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","toolTipExpression"],e).setIn(["functionConfig","toolTip"],""),useDataSources:s}),this.setState({isToolTipPopupOpen:!1})},this.onAltTextExpChange=e=>{if(!e)return;const t=this.getSrcExpression(),i=this.getToolTipExpression(),s=this.mergeUseDataSources(t,i,e);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","altTextExpression"],e).setIn(["functionConfig","altText"],""),useDataSources:s}),this.setState({isAltTextPopupOpen:!1})},this.onSrcExpChange=e=>{if(!e)return;const t=this.getToolTipExpression(),i=this.getAltTextExpression(),s=this.mergeUseDataSources(e,t,i);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","srcExpression"],e).setIn(["functionConfig","imageParam"],this.resetImageParam(this.props.config.functionConfig.imageParam)),useDataSources:s}),this.setState({isSrcPopupOpen:!1})},this.mergeUseDataSources=(e,t,s)=>{const o=i.expressionUtils.getUseDataSourceFromExpParts(e&&e.parts,this.props.useDataSources),a=i.expressionUtils.getUseDataSourceFromExpParts(t&&t.parts,this.props.useDataSources),n=i.expressionUtils.getUseDataSourceFromExpParts(s&&s.parts,this.props.useDataSources);return this.mergeUseDataSourcesByDss(o,a,n)},this.mergeUseDataSourcesByDss=(e,t,s)=>{const o=this.getUseDataSourcesWithoutFields();let a=i.expressionUtils.mergeUseDataSources(o,t);return a=i.expressionUtils.mergeUseDataSources(a,s),a=i.expressionUtils.mergeUseDataSources(a,e),a},this.onResourceChange=e=>{let t=e;t||(t={});let s=(0,i.Immutable)(this.props.config.functionConfig);s.imageParam&&s.imageParam.cropParam&&(t.cropParam={svgViewBox:s.imageParam.cropParam.svgViewBox,svgPath:s.imageParam.cropParam.svgPath,cropShape:s.imageParam.cropParam.cropShape}),s=s.set("imageParam",t),s=s.set("imgSourceType",""),s=s.set("srcExpression",null),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("functionConfig",s)})},this.resetImageParam=e=>e&&e.cropParam?{cropParam:e.cropParam}:null,this.onToggleUseDataEnabled=e=>{this.props.onSettingChange({id:this.props.id,useDataSourcesEnabled:e})},this.onDataSourceChange=e=>{e&&this.props.onSettingChange({id:this.props.id,useDataSources:e,config:this.props.config.setIn(["functionConfig","dynamicUrlType"],null).setIn(["functionConfig","altTextWithAttachmentName"],null).setIn(["functionConfig","toolTipWithAttachmentName"],null).setIn(["functionConfig","isSelectedFromRepeatedDataSourceContext"],null).setIn(["functionConfig","useDataSourceForMainDataAndViewSelector"],null)})},this.onTypeNoSupportChange=()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","dynamicUrlType"],null).setIn(["functionConfig","altTextWithAttachmentName"],null).setIn(["functionConfig","toolTipWithAttachmentName"],null).setIn(["functionConfig","isSelectedFromRepeatedDataSourceContext"],null).setIn(["functionConfig","useDataSourceForMainDataAndViewSelector"],null)})},this.onDataSourceRemoved=()=>{this.props.onSettingChange({id:this.props.id,useDataSources:[],config:this.props.config.setIn(["functionConfig","dynamicUrlType"],null).setIn(["functionConfig","altTextWithAttachmentName"],null).setIn(["functionConfig","toolTipWithAttachmentName"],null)})},this.handleChooseShape=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","imageParam","cropParam"],e)})},this.handleImageFillModeChange=e=>{let t=this.props.config.setIn(["functionConfig","imageFillMode"],e);t.functionConfig.imageParam&&t.functionConfig.imageParam.originalUrl&&(t=t.setIn(["functionConfig","imageParam","url"],t.functionConfig.imageParam.originalUrl)),t.functionConfig.imageParam&&t.functionConfig.imageParam.cropParam&&(t=t.setIn(["functionConfig","imageParam","cropParam"],{svgViewBox:t.functionConfig.imageParam.cropParam.svgViewBox,svgPath:t.functionConfig.imageParam.cropParam.svgPath,cropShape:t.functionConfig.imageParam.cropParam.cropShape})),this.props.onSettingChange({id:this.props.id,config:t})},this.getIsDataSourceUsed=()=>this.props.useDataSourcesEnabled,this.handleSymbolScaleChange=e=>{const t=parseFloat(e);t!==this.props.config.functionConfig.symbolScale&&(clearTimeout(this.onSymbolScaleChanged),this.onSymbolScaleChanged=setTimeout((()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","symbolScale"],t)})}),500))},this.onToolTipTextInputChange=e=>{this.setState({currentTipInput:e})},this.onAltTextTextInputChange=e=>{this.setState({currentAltTextInput:e})},this.onToolTipWithSomeKeyChange=(e,t)=>{const i={id:this.props.id,config:this.props.config.setIn(["functionConfig","toolTip"],null).setIn(["functionConfig","toolTipExpression"],null).setIn(["functionConfig",e],t),useDataSources:this.getUseDataSourcesWithoutFields()};this.props.onSettingChange(i)},this.onAltTextWithSomeKeyChange=(e,t)=>{const i={id:this.props.id,config:this.props.config.setIn(["functionConfig","altText"],null).setIn(["functionConfig","altTextExpression"],null).setIn(["functionConfig",e],t),useDataSources:this.getUseDataSourcesWithoutFields()};this.props.onSettingChange(i)},this.onTabSelect=t=>{"dynamicSource"===t?this.imgSourceTypeChanged(e.ByDynamicUrl):this.imgSourceTypeChanged(e.ByUpload)},this.onSelectedUseDsChangeForSymbol=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","useDataSourceForMainDataAndViewSelector"],e).setIn(["functionConfig","isSelectedFromRepeatedDataSourceContext"],t)})},this.onSelectedUseDsChangeForAttachment=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","useDataSourceForMainDataAndViewSelector"],e).setIn(["functionConfig","isSelectedFromRepeatedDataSourceContext"],t)})},this.getWhetherDsIdInUseDss=e=>{if(!e)return!1;const t=this.props.useDataSources||[];if(e.split("-").reverse()[0]===i.CONSTANTS.SELECTION_DATA_VIEW_ID){const s=i.DataSourceManager.getInstance().getDataSource(e),o=s&&s.getMainDataSource(),a=o&&o.id;return t.some((e=>e.mainDataSourceId===a))}return t.some((t=>t.dataSourceId===e))},this.onImageDisplayQualityChange=e=>{const{value:t}=e.currentTarget,i=o.imageUtils.getImageDisplayQualityModeByValue(t);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","imageDisplayQualityMode"],i)})},this.state={currentTipInput:this.props.config.functionConfig.toolTip,currentAltTextInput:this.props.config.functionConfig.altText,shadowOpen:!!this.props.config.styleConfig.boxShadow,isSrcPopupOpen:!1,isToolTipPopupOpen:!1,isAltTextPopupOpen:!1}}getStyle(e){return i.css`
      .widget-setting-image {
        font-size: 13px;
        font-weight: lighter;
        overflow-y: auto;

        .setting-function {

          .setting-function-item {
            overflow: hidden;

            .setting-function-item-input {
              width: 200px;
            }
          }
        }

        .widget-image-chooseshape-item {
          border: 2px solid transparent;
        }

        .border-selected {
          border: 2px solid ${e.colors.palette.primary[600]} !important;
        }

        .uploadInput {
          position: absolute;
          opacity: 0;
          left: 0;
          top: 0;
          cursor: pointer;
        }

        .uploadFileName {
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          opacity: 0.5;
        }

        .uploadInput-container {
          position: relative;
        }

        .setting-exterior {

          .exterior-shape-item {
            padding-bottom: 100%;
            cursor: pointer;
          }
        }

        .setting-stylepicker-selected {
          border-width: 2px !important;
        }

        .set-link-btn{
          background-color: ${e.colors.palette.light[500]};
        }
        .set-link-btn:hover, .set-link-btn:hover.set-link-btn:active{
          background-color: ${e.colors.palette.light[400]};
        }

        .set-clear-image {
          &:focus {
            outline: none;
            box-shadow: none !important;
            text-decoration: none;
          }
        }

        .set-image-display-quality .image-display-quality-option {
          font-weight: 500;
          font-size: 12px;
          line-height: 16px;
        }
      }
    `}componentDidUpdate(t){var s,a,n,p,r,l,c,g,h,u;if(this.props.useDataSourcesEnabled!==t.useDataSourcesEnabled){const t=this.props.useDataSourcesEnabled;let s=(0,i.Immutable)(this.props.config.functionConfig);t?this.props.config.functionConfig.imgSourceType===e.ByStaticUrl&&(s=s.set("imgSourceType",e.ByDynamicUrl)):this.props.config.functionConfig.imgSourceType===e.ByDynamicUrl&&(s=s.set("imgSourceType",e.ByStaticUrl)),this.props.onSettingChange({id:this.props.id,config:this.props.config.set("functionConfig",s)})}this.props.useDataSourcesEnabled||((null===(a=null===(s=this.props.config)||void 0===s?void 0:s.functionConfig)||void 0===a?void 0:a.toolTip)!==(null===(p=null===(n=t.config)||void 0===n?void 0:n.functionConfig)||void 0===p?void 0:p.toolTip)&&this.setState({currentTipInput:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip||""}),(null===(l=null===(r=this.props.config)||void 0===r?void 0:r.functionConfig)||void 0===l?void 0:l.altText)!==(null===(g=null===(c=t.config)||void 0===c?void 0:c.functionConfig)||void 0===g?void 0:g.altText)&&this.setState({currentAltTextInput:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.altText||""}),o.imageUtils.canUseImageDisplayQuality(null===(u=null===(h=this.props.config)||void 0===h?void 0:h.functionConfig)||void 0===u?void 0:u.imageParam)||this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","imageDisplayQualityMode"],i.ImageDisplayQualityMode.Orginial)}))}render(){var p,r,l,h,u,d;const{config:C,useDataSourcesEnabled:S}=this.props,{functionConfig:y}=C,I=(null===(p=null==y?void 0:y.imageParam)||void 0===p?void 0:p.originalName)||this.formatMessage("imageNoneSource"),v={[i.ImageDisplayQualityMode.Low]:this.formatMessage("displayQualityTooltipWithLow"),[i.ImageDisplayQualityMode.Medium]:this.formatMessage("displayQualityTooltipWithMedium"),[i.ImageDisplayQualityMode.High]:this.formatMessage("displayQualityTooltipWithHigh"),[i.ImageDisplayQualityMode.Orginial]:this.formatMessage("displayQualityTooltipWithOriginal")};return(0,i.jsx)("div",{css:this.getStyle(this.props.theme),className:"jimu-widget"},(0,i.jsx)("div",{className:"widget-setting-image"},(0,i.jsx)(s.SettingSection,null,(0,i.jsx)(s.SettingRow,null,(0,i.jsx)("div",{className:"choose-ds w-100"},(0,i.jsx)(n.DataSourceSelector,{types:this.supportedTypes,useDataSourcesEnabled:S,useDataSources:this.props.useDataSources,onToggleUseDataEnabled:this.onToggleUseDataEnabled,onChange:this.onDataSourceChange,widgetId:this.props.id}))),!S&&(0,i.jsx)(s.SettingRow,{label:this.formatMessage("imageSource"),role:"group","aria-label":this.formatMessage("imageSource"),flow:"wrap"},(0,i.jsx)("div",{className:"w-100 d-flex align-items-center"},(0,i.jsx)("div",{style:{minWidth:"60px"}},(0,i.jsx)(a.ImageSelector,{buttonClassName:"text-dark d-flex justify-content-center btn-browse",widgetId:this.props.id,buttonLabel:this.formatMessage("imageSet"),buttonSize:"sm",onChange:this.onResourceChange,imageParam:null==y?void 0:y.imageParam,"aria-describedby":"image-selected-name",trigger:this.displayQualityTrigger.current})),(0,i.jsx)("div",{style:{width:"70px"},className:"uploadFileName ml-2",title:I},I),(0,i.jsx)("div",{id:"image-selected-name",style:{display:"none"}},this.formatMessage("numSelected",{number:I})))),!window.jimuConfig.isDevEdition&&!S&&(null===(r=null==y?void 0:y.imageParam)||void 0===r?void 0:r.originalUrl)&&o.imageUtils.canUseImageDisplayQuality(null===(l=this.props.config.functionConfig)||void 0===l?void 0:l.imageParam)&&(0,i.jsx)(s.SettingRow,{className:"flex-wrap",label:this.formatMessage("imageDisplayQuality"),role:"group","aria-label":this.formatMessage("imageDisplayQuality"),flow:"wrap"},(0,i.jsx)("div",{className:"set-image-display-quality w-100 d-flex flex-wrap align-items-center"},(0,i.jsx)(o.Tooltip,{placement:"bottom",title:v[this.props.config.functionConfig.imageDisplayQualityMode]},(0,i.jsx)(o.Slider,{ref:this.displayQualityTrigger,style:{transform:"translateY(-4px)"},className:"image-display-quality-range",list:"image-display-quality-datalist","aria-label":"set-image-display-quality","data-field":"space",defaultValue:o.imageUtils.getImageDisplayQualityValueByMode(this.props.config.functionConfig.imageDisplayQualityMode),min:0,max:99.99,step:33.33,onChange:this.onImageDisplayQualityChange})),(0,i.jsx)("datalist",{id:"image-display-quality-datalist",className:"display-none"},(0,i.jsx)("option",{value:"0",label:v[i.ImageDisplayQualityMode.Low]}),(0,i.jsx)("option",{value:"99.99",label:v[i.ImageDisplayQualityMode.Orginial]})),(0,i.jsx)("div",{className:"image-display-quality-option-wrapper text-dark-400 d-flex w-100 justify-content-between",style:{marginTop:"4px"}},(0,i.jsx)("div",{className:"image-display-quality-option"},v[i.ImageDisplayQualityMode.Low]),(0,i.jsx)("div",{className:"image-display-quality-option"},v[i.ImageDisplayQualityMode.Orginial])))),S&&(0,i.jsx)("div",{className:"mt-3"},(0,i.jsx)(o.Tabs,{fill:!0,type:"pills",onChange:this.onTabSelect,value:this.props.config.functionConfig.imgSourceType===e.ByDynamicUrl?"dynamicSource":"staticSource"},(0,i.jsx)(o.Tab,{id:"staticSource",title:this.formatMessage("staticSource")},(0,i.jsx)("div",{className:"mt-3"},(!this.props.config.functionConfig.imgSourceType||this.props.config.functionConfig.imgSourceType===e.ByUpload)&&(0,i.jsx)(s.SettingRow,null,(0,i.jsx)("div",{className:"w-100 d-flex align-items-center"},(0,i.jsx)("div",{style:{minWidth:"60px"}},(0,i.jsx)(a.ImageSelector,{buttonClassName:"text-dark d-flex justify-content-center btn-browse",widgetId:this.props.id,buttonLabel:this.formatMessage("imageSet"),buttonSize:"sm",disabled:this.props.config.functionConfig.imgSourceType===e.ByStaticUrl||this.props.config.functionConfig.imgSourceType===e.ByDynamicUrl,onChange:this.onResourceChange,imageParam:this.props.config.functionConfig.imageParam,buttonDescribedby:"image-ds-selected-name"})),(0,i.jsx)("div",{style:{width:"70px"},className:"uploadFileName ml-2",title:I},I),(0,i.jsx)("div",{id:"image-ds-selected-name",style:{display:"none"}},this.formatMessage("numSelected",{number:I})))))),(0,i.jsx)(o.Tab,{id:"dynamicSource",title:this.formatMessage("dynamicSource")},(0,i.jsx)("div",{className:"mt-3"},this.props.config.functionConfig.imgSourceType===e.ByDynamicUrl&&(0,i.jsx)(x,{dynamicUrlType:this.props.config.functionConfig.dynamicUrlType,srcExpression:this.getSrcExpression(),useDataSources:this.props.useDataSources,isSrcPopupOpen:this.state.isSrcPopupOpen,onDynamicUrlTypeChanged:this.dynamicUrlTypeChanged,onSrcExpChange:this.onSrcExpChange,openSrcPopup:this.openSrcPopup,closeSrcPopup:this.closeSrcPopup,widgetId:this.props.id,intl:this.props.intl,isSelectedFromRepeatedDataSourceContext:this.props.config.functionConfig.isSelectedFromRepeatedDataSourceContext,useDataSourceForMainDataAndViewSelector:this.getWhetherDsIdInUseDss(null===(u=null===(h=this.props.config.functionConfig)||void 0===h?void 0:h.useDataSourceForMainDataAndViewSelector)||void 0===u?void 0:u.dataSourceId)?this.props.config.functionConfig.useDataSourceForMainDataAndViewSelector:null,onSelectedUseDsChangeForSymbol:this.onSelectedUseDsChangeForSymbol,onSelectedUseDsChangeForAttachment:this.onSelectedUseDsChangeForAttachment,onTypeNoSupportChange:this.onTypeNoSupportChange})))))),(0,i.jsx)(s.SettingSection,null,(0,i.jsx)(s.SettingRow,null,(0,i.jsx)(s.LinkSelector,{onSettingConfirm:this.settingLinkConfirm,linkParam:this.props.config.functionConfig.linkParam,useDataSources:this.getIsDataSourceUsed()&&this.props.useDataSources,widgetId:this.props.id})),(0,i.jsx)(m,{imgSourceType:this.props.config.functionConfig.imgSourceType,dynamicUrlType:this.props.config.functionConfig.dynamicUrlType,intl:this.props.intl,useDataSourcesEnabled:S,useDataSources:this.props.useDataSources,openToolTipPopup:this.openToolTipPopup,closeToolTipPopup:this.closeToolTipPopup,toolTipExpression:this.getToolTipExpression(),onToolTipExpChange:this.onToolTipExpChange,isToolTipPopupOpen:this.state.isToolTipPopupOpen,toolTipConfigChange:this.toolTipConfigChange,onToolTipTextInputChange:this.onToolTipTextInputChange,toolTipText:this.state.currentTipInput,widgetId:this.props.id,toolTipWithAttachmentName:this.props.config.functionConfig.toolTipWithAttachmentName,onToolTipWithAttachmentNameChange:e=>{this.onToolTipWithSomeKeyChange("toolTipWithAttachmentName",e)}}),(0,i.jsx)(f,{imgSourceType:this.props.config.functionConfig.imgSourceType,dynamicUrlType:this.props.config.functionConfig.dynamicUrlType,intl:this.props.intl,useDataSourcesEnabled:S,useDataSources:this.props.useDataSources,openAltTextPopup:this.openAltTextPopup,closeAltTextPopup:this.closeAltTextPopup,altTextExpression:this.getAltTextExpression(),onAltTextExpChange:this.onAltTextExpChange,isAltTextPopupOpen:this.state.isAltTextPopupOpen,altTextConfigChange:this.altTextConfigChange,onAltTextTextInputChange:this.onAltTextTextInputChange,altTextText:this.state.currentAltTextInput,widgetId:this.props.id,altTextWithAttachmentName:this.props.config.functionConfig.altTextWithAttachmentName,onAltTextWithAttachmentNameChange:e=>{this.onAltTextWithSomeKeyChange("altTextWithAttachmentName",e)}})),(0,i.jsx)(s.SettingSection,null,(null==y?void 0:y.dynamicUrlType)!==t.Symbol&&(0,i.jsx)(s.SettingRow,{label:this.formatMessage("imagePosition")},(0,i.jsx)("div",{style:{width:"50%"}},(0,i.jsx)(o.Select,{size:"sm",value:(null==y?void 0:y.imageFillMode)||o.ImageFillMode.Fill,onChange:e=>this.handleImageFillModeChange(e.target.value),"aria-label":this.formatMessage("imagePosition")},(0,i.jsx)("option",{key:0,value:o.ImageFillMode.Fill},this.props.intl.formatMessage({id:"imageFill",defaultMessage:c.imageFill})),(0,i.jsx)("option",{key:1,value:o.ImageFillMode.Fit},this.props.intl.formatMessage({id:"imageFit",defaultMessage:c.imageFit}))))),(null==y?void 0:y.dynamicUrlType)===t.Symbol&&(0,i.jsx)(s.SettingRow,{flow:"wrap",label:this.formatMessage("imageSymbolScale")},(0,i.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},(0,i.jsx)(o.Slider,{style:{width:"60%"},"data-field":"space",onChange:e=>{this.handleSymbolScaleChange(e.currentTarget.value)},value:this.props.config.functionConfig.symbolScale?this.props.config.functionConfig.symbolScale:1,title:"0.5-5",size:"sm",min:this.minSymbolScale,max:this.maxSymbolScale,step:this.SymbolScaleStep}),(0,i.jsx)(o.NumericInput,{style:{width:"35%"},showHandlers:!1,min:this.minSymbolScale,max:this.maxSymbolScale,value:this.props.config.functionConfig.symbolScale?this.props.config.functionConfig.symbolScale:1,onBlur:e=>{this.handleSymbolScaleChange(e.currentTarget.value)},title:"0.5-5"}))),(null==y?void 0:y.dynamicUrlType)!==t.Symbol&&(0,i.jsx)(s.SettingRow,{flow:"wrap",label:this.formatMessage("imageShape"),role:"group","aria-label":this.formatMessage("imageShape")},(0,i.jsx)(g,{theme:this.props.theme,cropParam:null===(d=null==y?void 0:y.imageParam)||void 0===d?void 0:d.cropParam,onShapeChoosed:e=>{this.handleChooseShape(e)},intl:this.props.intl})))))}}S.mapExtraStateProps=e=>({preDefinedConfigs:p})})(),l})())}}}));