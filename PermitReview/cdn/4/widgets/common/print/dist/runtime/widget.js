System.register(["jimu-core","jimu-ui","jimu-arcgis"],(function(e,t){var l={},n={},i={};return{setters:[function(e){l.BaseVersionManager=e.BaseVersionManager,l.Immutable=e.Immutable,l.React=e.React,l.ReactRedux=e.ReactRedux,l.UtilityManager=e.UtilityManager,l.appActions=e.appActions,l.classNames=e.classNames,l.css=e.css,l.defaultMessages=e.defaultMessages,l.esri=e.esri,l.hooks=e.hooks,l.jsx=e.jsx,l.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,l.lodash=e.lodash,l.moduleLoader=e.moduleLoader,l.polished=e.polished},function(e){n.Badge=e.Badge,n.Button=e.Button,n.Checkbox=e.Checkbox,n.Icon=e.Icon,n.Nav=e.Nav,n.NavItem=e.NavItem,n.NavLink=e.NavLink,n.Navbar=e.Navbar,n.NumericInput=e.NumericInput,n.Option=e.Option,n.Popper=e.Popper,n.Radio=e.Radio,n.SVG=e.SVG,n.Select=e.Select,n.TextInput=e.TextInput,n.WidgetPlaceholder=e.WidgetPlaceholder,n.defaultMessages=e.defaultMessages,n.getFallbackPlacementsModifier=e.getFallbackPlacementsModifier},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent,i.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules}],execute:function(){e((()=>{var e={60171:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#C5C5C5" fill-rule="evenodd" d="M2.4.8V4h-.8A1.6 1.6 0 0 0 0 5.6v3.2a1.6 1.6 0 0 0 1.136 1.532c.249.075.464-.143.464-.403 0-.182-.154-.323-.32-.396A.8.8 0 0 1 .8 8.8V5.6a.8.8 0 0 1 .8-.8h12.8a.8.8 0 0 1 .8.8v3.2a.8.8 0 0 1-.48.733c-.166.073-.32.214-.32.396 0 .26.215.478.464.403A1.6 1.6 0 0 0 16 8.8V5.6A1.6 1.6 0 0 0 14.4 4h-.8V.8a.8.8 0 0 0-.8-.8H3.2a.8.8 0 0 0-.8.8Zm10.4 0H3.2V4h9.6V.8Z" clip-rule="evenodd"></path><path fill="#C5C5C5" d="M5.2 10.4a.4.4 0 0 0 0 .8h5.6a.4.4 0 0 0 0-.8H5.2ZM5.2 12.8a.4.4 0 0 0 0 .8h3.2a.4.4 0 0 0 0-.8H5.2Z"></path><path fill="#C5C5C5" fill-rule="evenodd" d="M2.4 15.2V8.8H2A.4.4 0 0 1 2 8h12a.4.4 0 0 1 0 .8h-.4v6.4a.8.8 0 0 1-.8.8H3.2a.8.8 0 0 1-.8-.8Zm10.4-6.4v6.4H3.2V8.8h9.6Z" clip-rule="evenodd"></path><path fill="#C5C5C5" d="M12 6c0-.22.18-.4.4-.4h.8a.4.4 0 0 1 0 .8h-.8A.4.4 0 0 1 12 6Z"></path></svg>'},51513:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 12"><path fill="#000" fill-rule="evenodd" d="M10.167 0H1.833A.845.845 0 0 0 1 .857v10.286c0 .473.373.857.833.857h8.334c.46 0 .833-.384.833-.857V.857A.845.845 0 0 0 10.167 0ZM2 11V1h8v10H2Zm1.6-8h4.8c.331 0 .6.224.6.5s-.269.5-.6.5H3.6c-.331 0-.6-.224-.6-.5s.269-.5.6-.5Zm4.8 3H3.6c-.331 0-.6.224-.6.5s.269.5.6.5h4.8c.331 0 .6-.224.6-.5S8.731 6 8.4 6Z" clip-rule="evenodd"></path></svg>'},59788:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .538.538 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.538.538 0 0 1 0-.738Z" clip-rule="evenodd"></path></svg>'},96009:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .538.538 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.538.538 0 0 1 0 .738Z" clip-rule="evenodd"></path></svg>'},55339:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746L8.746 8Z"></path></svg>'},27218:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8Z"></path></svg>'},94539:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M4 4.796 4.796 4 8.02 7.224l3.184-3.184.796.796L8.816 8.02l3.144 3.144-.796.796L8.02 8.816 4.836 12l-.796-.796L7.224 8.02 4 4.796Z"></path><path fill="#000" fill-rule="evenodd" d="m0 4 4-4h8l4 4v8l-4 4H4l-4-4V4Zm1 .414L4.414 1h7.172L15 4.414v7.172L11.586 15H4.414L1 11.586V4.414Z" clip-rule="evenodd"></path></svg>'},26826:e=>{"use strict";e.exports=i},48891:e=>{"use strict";e.exports=l},30726:e=>{"use strict";e.exports=n}},t={};function o(l){var n=t[l];if(void 0!==n)return n.exports;var i=t[l]={exports:{}};return e[l](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="";var a={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(a),o.d(a,{__set_webpack_public_path__:()=>Ve,default:()=>ze});var e=o(48891),t=o(30726),l=o(26826);const n="CIMMarkerNorthArrow";var i,r;!function(e){e.CurrentMapExtent="CURRENT MAP EXTENT",e.CurrentMapScale="CURRENT MAP SCALE",e.SetMapScale="SET MAP SCALE"}(i||(i={})),function(e){e.Point="POINT",e.Inch="INCH",e.Centimeter="CENTIMETER",e.Millimeter="MILLIMETER"}(r||(r={}));const s={layoutOptions:{customTextElements:[],hasAuthorText:!0,hasCopyrightText:!0,hasLegend:!0,hasTitleText:!0},mapSurroundInfos:[],pageSize:null,pageUnits:null,webMapFrameSize:null},u={scalePreserved:!1,outScale:36978595.474472,layoutOptions:{titleText:"ArcGIS Web Map"},exportOptions:{dpi:96},printExtentType:i.CurrentMapExtent,attributionVisible:!1,forceFeatureAttributes:!0,wkid:102100,wkidLabel:"WGS_1984_Web_Mercator_Auxiliary_Sphere",enableTitle:!0,legendEnabled:!0,enableMapPrintExtents:!0,enableOutputSpatialReference:!0,enableQuality:!0,enableFeatureAttribution:!0,enableMapSize:!0,overrideCommonSetting:!1,enableAuthor:!0,enableCopyright:!0,enableLegend:!0,enableScalebarUnit:!0,enableCustomTextElements:!0};var d,c,v,p,m;!function(e){e.Classic="CLASSIC",e.Compact="COMPACT"}(d||(d={})),function(e){e.OrganizationService="ORGANIZATION SERVICE",e.Customize="CUSTOMIZE"}(c||(c={})),function(e){e.OrganizationTemplate="ORGANIZATION TEMPLATE",e.Customize="CUSTOMIZE"}(v||(v={})),function(e){e.Loading="LOADING",e.Success="SUCCESS",e.Error="ERROR"}(p||(p={})),function(e){e.PrintTemplate="PRINT TEMPLATE",e.PrintResult="PRINT RESULT"}(m||(m={}));var h=o(60171),x=o.n(h);const f={_widgetLabel:"Print",printPleaceholder:"Select or switch to a webmap to enable print.",chooseMapTip:"Please select a map with 2D data.",chooseUseUtility:"Please select utility.",printTemplate:"Print template",printResult:"Print result",previewPrint:"Preview print extents",fileFormat:"File format",mapPrintingExtents:"Map printing extents",outputSpatialReference:"Output spatial reference",printQuality:"Print quality",featureAttribution:"Feature attribution",selectEditableSettings:"Select editable settings",currentMapExtent:"Current map extent",currentMapScale:"Current map scale",setMapScale:"Set map scale",useCurrentScale:"Use current scale",wellKnownId:"Enter a well-known ID ({wkid})",allowEditing:"Select settings that allow editing at runtime",includeAttribution:"Include attribution",includeAttributes:"Include attributes",includeLegend:"Include legend",templateConfiguration:"Template configuration",templateName:"Template name",printLayout:"Layout",MapOnlyOptions:"Map-only options",LayoutOptions:"Layout options",mapSize:"Map size",spatialReference:"Output spatial reference {WKID}",printAuyhor:"Author",printCopyright:"Copyright",scaleBarUnit:"Scalebar unit",mapAttribution:"Map attribution",resultEmptyMessage:"Your printed files will appear here.",northArrow:"North arrow",includeNorthArrow:"Include north arrow"};var g,b=function(e,t,l,n){return new(l||(l=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function r(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(a,r)}s((n=n.apply(e,t||[])).next())}))};!function(e){e.AsynchronousSubmit="esriExecutionTypeAsynchronous",e.SynchronousExecute="esriExecutionTypeSynchronous"}(g||(g={}));const y=(t,l)=>{let n=l;return(null==t?void 0:t.exportOptions)&&(n=n.set("exportOptions",Object.assign(Object.assign({},t.exportOptions||{}),(null==l?void 0:l.exportOptions)||{}))),(null==t?void 0:t.layoutOptions)&&(null==l?void 0:l.layoutOptions)&&(n=n.set("layoutOptions",Object.assign(Object.assign({},(null==t?void 0:t.layoutOptions)||{}),(null==l?void 0:l.layoutOptions)||{}))),(0,e.Immutable)(Object.assign(Object.assign({},t),n))},w=(e,t)=>{let l;return null==e||e.forEach(((e,n)=>{(null==e?void 0:e.templateId)===t&&(l=n)})),l},j=e=>"map-only"===(e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.replace(/\_/gi,"-"))||void 0===t?void 0:t.replace(/\s+/gi,"-"))||void 0===l?void 0:l.toLowerCase()})(e),O=(e,t)=>{let l=!1;return null==e||e.forEach((e=>{(null==e?void 0:e.templateId)===t&&(l=!0)})),l},S=t=>b(void 0,void 0,void 0,(function*(){return e.UtilityManager.getInstance().getUrlOfUseUtility(t).then((e=>Promise.resolve(e)))}));function N(t){return b(this,void 0,void 0,(function*(){return(0,e.loadArcGISJSAPIModules)(["esri/rest/support/LegendLayer"]).then((e=>{var l,n,i;const[o]=e,a=I((null===(i=null===(n=null===(l=null==t?void 0:t.view)||void 0===l?void 0:l.map)||void 0===n?void 0:n.layers)||void 0===i?void 0:i.toArray())||[],o);return Promise.resolve(a)}))}))}function I(e,t){if(!e)return[];let l=[];return null==e||e.forEach((e=>{var n;if("graphics"!==e.type&&e.visible&&(null==e?void 0:e.legendEnabled)){const i=(null==e?void 0:e.subLayerIds)||null;if("group"===(null==e?void 0:e.type)){const i=I((null===(n=null==e?void 0:e.layers)||void 0===n?void 0:n._items)||[],t)||[];l=l.concat(i)}const o=new t({layerId:null==e?void 0:e.id,title:null==e?void 0:e.title,subLayerIds:i});l.push(o)}})),l}function T(e={}){var t;let l=null;for(const i in e)(null===(t=null==e?void 0:e[i])||void 0===t?void 0:t.type)===n&&(l=i);return l}var M=o(59788),C=o.n(M);const P=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:C()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var E=o(96009),k=o.n(E);const L=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:k()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var A=o(27218),R=o.n(A);const z=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:R()},i)):e.React.createElement("svg",Object.assign({className:o},i))},V=t=>{const{label:l,className:n,children:i,flowWrap:o}=t,a=e.css`
    .title {
      font-size: 14px;
    }
  `;return(0,e.jsx)("div",{className:(0,e.classNames)("mb-2 align-items-center",{className:n,"d-flex":!o}),css:a},(0,e.jsx)("div",{className:(0,e.classNames)("title flex-grow-1",{"mb-2":o})},l),i)};const U=(e,t)=>{let l=1,n=e;return t.forEach((i=>{n===(null==i?void 0:i.title)&&(n=`${e} (${l})`,l++,U(n,t))})),n},F=e=>{const t=(e=>{var t;return e?null===(t=null==e?void 0:e.asMutable())||void 0===t?void 0:t.map((e=>e.resultId)):[]})(e);return t&&0!==(null==t?void 0:t.length)?`config_${$(t)+1}`:"result_0"},$=e=>{var t;if(!e||0===(null==e?void 0:e.length))return 0;const l=null==e?void 0:e.map((e=>{var t;const l=null===(t=null==e?void 0:e.split("_"))||void 0===t?void 0:t.pop();return l?Number(l):0}));return null===(t=null==l?void 0:l.sort(((e,t)=>t-e)))||void 0===t?void 0:t[0]};function _(e,t){return"print-extents-layer-"+e+"-"+t}function B(e,t,l){var n,o,a,r,s,u,d,c;return s=this,u=void 0,c=function*(){const s=!1===(null==e?void 0:e.hasTitleText),u=!1===(null==e?void 0:e.hasLegend);let d=e.without("enableTitle","enableAuthor","enableOutputSpatialReference","enableMapPrintExtents","enableQuality","enableMapSize","enableFeatureAttribution","enableCopyright","enableLegend","enableMapAttribution","enableCustomTextElements","hasAuthorText","hasCopyrightText","hasLegend","hasTitleText","selectedFormatList","mapFrameSize","mapFrameUnit","legendEnabled","templateId","printExtentType","customTextElementEnableList");switch(null==e?void 0:e.printExtentType){case i.CurrentMapExtent:d=d.set("scalePreserved",!1);break;case i.CurrentMapScale:d=d.set("outScale",null===(n=null==t?void 0:t.view)||void 0===n?void 0:n.scale).set("scalePreserved",!0);break;case i.SetMapScale:d=d.set("scalePreserved",!0)}let c=null==d?void 0:d.asMutable({deep:!0});return s&&(null===(o=null==c?void 0:c.layoutOptions)||void 0===o||delete o.titleText),u&&(null===(a=null==c?void 0:c.layoutOptions)||void 0===a||delete a.legendLayers),(null===(r=null==e?void 0:e.layoutOptions)||void 0===r?void 0:r.legendLayers)?c.layoutOptions.legendLayers=yield N(t):c.layoutOptions.legendLayers=[],c=function(e,t){var l;const n=(null===(l=e.layoutOptions)||void 0===l?void 0:l.customTextElements)||[];let i=!1;return n.forEach((e=>{e.date&&(i=!0)})),i||n.push({Date:(new Date).toLocaleString(t)}),e.layoutOptions.customTextElements=n,e}(c,l),Promise.resolve(c)},new((d=void 0)||(d=Promise))((function(e,t){function l(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof d?i:new d((function(e){e(i)}))).then(l,n)}i((c=c.apply(s,u||[])).next())}))}function W(e,t,l){const n=(i=l)?{XDPI:i,YDPI:i}:function(){const e={XDPI:null,YDPI:null},t=window.screen;if(null==t?void 0:t.XDPI)e.XDPI=null==t?void 0:t.deviceXDPI,e.YDPI=null==t?void 0:t.deviceYDPI;else{const t=document.createElement("div");t.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(t),e.XDPI=t.offsetWidth,e.YDPI=t.offsetHeight,t.parentNode.removeChild(t)}return e}();var i;return e/(t?n.XDPI:n.YDPI)*2.54/100}const{useState:G,useEffect:D,useRef:J}=e.React,Z=l=>{var n,o,a,s;const{jimuMapView:u,id:d,selectedTemplate:c,className:v}=l,p=e.hooks.useTranslation(f,t.defaultMessages),m=J(null),h=J(null),x=J(null),g=J(null===(n=null==u?void 0:u.view)||void 0===n?void 0:n.extent),b=J(null===(o=null==u?void 0:u.view)||void 0===o?void 0:o.scale),y=e.css`
    .checkbox-con {
      color: var(--dark-800);
      font-size: ${e.polished.rem(14)};
      line-height: ${e.polished.rem(22)};
      margin: ${e.polished.rem(4)} 0 ${e.polished.rem(8)} 0;
    }
  `,[w,O]=G(!1),[S,N]=G(null===(a=null==u?void 0:u.view)||void 0===a?void 0:a.extent),[I,T]=G(null===(s=null==u?void 0:u.view)||void 0===s?void 0:s.scale);D((()=>(x.current=e.lodash.debounce(P,400),(0,e.loadArcGISJSAPIModules)(["esri/layers/GraphicsLayer","esri/Graphic","esri/geometry/Polygon","esri/geometry/Extent","esri/geometry/Point","esri/geometry/support/WKIDUnitConversion"]).then((e=>{m.current=e})),U)),[]),D((()=>{var e,t,l,n,i,o;const a=(null==c?void 0:c.templateId)!==(null===(e=h.current)||void 0===e?void 0:e.templateId),r=(null==c?void 0:c.printExtentType)!==(null===(t=h.current)||void 0===t?void 0:t.printExtentType),s=(null==c?void 0:c.outScale)!==(null===(l=h.current)||void 0===l?void 0:l.outScale),u=(null===(n=null==c?void 0:c.exportOptions)||void 0===n?void 0:n.dpi)!==(null===(o=null===(i=h.current)||void 0===i?void 0:i.exportOptions)||void 0===o?void 0:o.dpi),d=M();h.current=c,w&&(a||r||s||d||u)&&x.current()}),[c]),D((()=>{w&&S&&x.current()}),[S,I]),D((()=>{var t,l;u?(C(),N((0,e.Immutable)(JSON.parse(JSON.stringify(null===(l=null===(t=null==u?void 0:u.view)||void 0===t?void 0:t.extent)||void 0===l?void 0:l.toJSON()))))):N(null)}),[u]);const M=()=>{var e,t,l,n,i,o;if(!j(null==c?void 0:c.layout))return!1;const a=(null===(e=null==c?void 0:c.exportOptions)||void 0===e?void 0:e.width)!==(null===(l=null===(t=h.current)||void 0===t?void 0:t.exportOptions)||void 0===l?void 0:l.width),r=(null===(n=null==c?void 0:c.exportOptions)||void 0===n?void 0:n.height)!==(null===(o=null===(i=h.current)||void 0===i?void 0:i.exportOptions)||void 0===o?void 0:o.height);return a||r},C=()=>{var t,l;null===(t=null==u?void 0:u.view)||void 0===t||t.watch("extent",(t=>{const l=JSON.parse(JSON.stringify(t.toJSON()));N((0,e.Immutable)(l)),g.current=t})),null===(l=null==u?void 0:u.view)||void 0===l||l.watch("scale",(e=>{T(e),b.current=e}))},P=()=>{var e;const t=V(),l=new(0,m.current[1])((null===(e=h.current)||void 0===e?void 0:e.printExtentType)===i.CurrentMapExtent?k():E(),{type:"simple-fill",color:[0,216,237,.3],outline:{color:[0,0,0],width:"4px"}});t.graphics.removeAll(),t.graphics.add(l)},E=()=>{var e,t,l,n,o;const{mapFrameSize:a,mapFrameUnit:r,layout:s}=null===(e=h.current)||void 0===e?void 0:e.asMutable({deep:!0}),u=z(),d=R(r),c=m.current[2],v=j(s),p=null===(t=null==g?void 0:g.current)||void 0===t?void 0:t.center,x=(null===(l=h.current)||void 0===l?void 0:l.printExtentType)===i.SetMapScale?null===(n=h.current)||void 0===n?void 0:n.outScale:b.current,f=v?A():{width:a[0],height:a[1]},y={x:v?1:d.x/(null==u?void 0:u.x),y:v?1:d.y/(null==u?void 0:u.y)},w={x:f.width,y:f.height},O=(null==p?void 0:p.x)-(null==w?void 0:w.x)/2*x*(null==y?void 0:y.x),S=(null==p?void 0:p.y)-(null==w?void 0:w.y)/2*x*(null==y?void 0:y.y),N=(null==p?void 0:p.x)+(null==w?void 0:w.x)/2*x*(null==y?void 0:y.x),I=(null==p?void 0:p.y)+(null==w?void 0:w.y)/2*x*(null==y?void 0:y.y),T=[[O,S],[O,I],[N,I],[N,S],[O,S]],M=new c({spatialReference:null===(o=null==g?void 0:g.current)||void 0===o?void 0:o.spatialReference});return M.addRing(T),M},k=()=>{var t,l,n,i,o,a;const r=m.current[3],{mapFrameSize:s,layout:d,exportOptions:c}=null===(t=h.current)||void 0===t?void 0:t.asMutable({deep:!0}),v=j(d),p=m.current[2];let x=(0,e.Immutable)(null===(l=g.current)||void 0===l?void 0:l.toJSON());const f=(null===(n=null==u?void 0:u.view)||void 0===n?void 0:n.width)/(null===(i=null==u?void 0:u.view)||void 0===i?void 0:i.height),b=v?(null==c?void 0:c.width)/(null==c?void 0:c.height):s[0]/s[1],y=(null==x?void 0:x.height)||(null===(o=null==u?void 0:u.view)||void 0===o?void 0:o.height),w=(null==x?void 0:x.width)||(null===(a=null==u?void 0:u.view)||void 0===a?void 0:a.width);if(f>b){const e=w/b,t=L(!1,e/y);x=x.set("height",e).set("ymin",null==t?void 0:t.mim).set("ymax",null==t?void 0:t.max)}else if(f<b){const e=y*b,t=L(!0,e/w);x=x.set("width",e).set("xmin",null==t?void 0:t.mim).set("xmax",null==t?void 0:t.max)}const O=new r({xmax:null==x?void 0:x.xmax,xmin:null==x?void 0:x.xmin,ymax:null==x?void 0:x.ymax,ymin:null==x?void 0:x.ymin,zmax:null==x?void 0:x.zmax,zmin:null==x?void 0:x.zmin,spatialReference:null==x?void 0:x.spatialReference});return p.fromExtent(O)},L=(e,t)=>{var l,n;const i=null===(l=g.current)||void 0===l?void 0:l.toJSON(),o=null===(n=null==g?void 0:g.current)||void 0===n?void 0:n.center,a=(e?(null==i?void 0:i.xmax)-(null==i?void 0:i.xmin):(null==i?void 0:i.ymax)-(null==i?void 0:i.ymin))*t;return{max:e?(null==o?void 0:o.x)+a/2:(null==o?void 0:o.y)+a/2,mim:e?(null==o?void 0:o.x)-a/2:(null==o?void 0:o.y)-a/2}},A=()=>{var e;const{exportOptions:t}=null===(e=h.current)||void 0===e?void 0:e.asMutable({deep:!0}),l=z();return{width:W(null==t?void 0:t.width,!0,null==t?void 0:t.dpi)*(null==l?void 0:l.x),height:W(null==t?void 0:t.height,!1,null==t?void 0:t.dpi)*(null==l?void 0:l.y)}},R=e=>{switch(null==e?void 0:e.toUpperCase()){case r.Centimeter:return{x:.01,y:.01};case r.Inch:return{x:.0254,y:.0254};case r.Millimeter:return{x:.001,y:.001};case r.Point:return{x:.0254/72,y:.0254/72};default:return{x:NaN,y:NaN}}},z=()=>{var e;const t=m.current[5];let l,n;const i=null===(e=null==g?void 0:g.current)||void 0===e?void 0:e.spatialReference;i&&(l=i.wkid,n=i.wkt);let o=null;if(l)o=t.values[t[l]];else if(n&&-1!==n.search(/^PROJCS/i)){const e=/UNIT\[([^\]]+)\]\]$/i.exec(n);e&&e[1]&&(o=parseFloat(e[1].split(",")[1]))}return{x:o,y:o}},V=()=>{var e;let t=null;const l=m.current[0],n=_(d,u.id);return(null===(e=u.view)||void 0===e?void 0:e.map)&&(t=u.view.map.findLayerById(n),t||(t=new l({id:n,listMode:"hide",title:n}),u.view.map.add(t))),t},U=()=>{if(F()&&u.view){const e=_(d,u.id),t=u.view.map.findLayerById(e);t&&t.graphics.removeAll()}},F=()=>!!j(null==c?void 0:c.layout)||!!(null==c?void 0:c.mapFrameSize);return(0,e.jsx)("div",{className:v,css:y},F()&&(0,e.jsx)("div",{title:p("previewPrint"),className:"d-flex w-100 align-items-center checkbox-con",onClick:()=>{O(!w),w?U():P()}},(0,e.jsx)(t.Checkbox,{title:p("previewPrint"),className:"lock-item-ratio","data-field":"mapSize",checked:w}),(0,e.jsx)("div",{className:"text-left ml-2 text-truncate"},p("previewPrint"))))};var H=function(e,t,l,n){return new(l||(l=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function r(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(a,r)}s((n=n.apply(e,t||[])).next())}))};const Q=new(0,e.esri.Sanitizer),{useState:K,useEffect:X,useRef:q}=e.React,Y=l=>{var n,o,a,r,s,u,d,c;const v=e.hooks.useTranslation(f,t.defaultMessages,e.defaultMessages),p=q(null),h=q(null),x=q(!1),g=e.css`
    padding-bottom: ${e.polished.rem(16)};
    padding-top: ${e.polished.rem(16)};
    .setting-con {
      overflow-y: auto;
      padding-left: ${e.polished.rem(16)};
      padding-right: ${e.polished.rem(16)};
    }
    .print-button-con {
      padding-left: ${e.polished.rem(16)};
      padding-right: ${e.polished.rem(16)};
    }
    .no-right-padding .jimu-interactive-node{
      padding-right: 0;
    }
    .scalebar-unit {
      width: ${e.polished.rem(160)};
    }
    .collapse-button {
      padding-right: 0;
    }
    .map-size-con input {
      width: 100%;
    }
    .wkid-describtion {
      font-size: ${e.polished.rem(12)};
      color: var(--dark-400);
    }
    .wkid-describtion-invalid {
      color: var(--danger-700)
    }
    .outscale-con, .dpi-con {
      input {
        border-right: 0;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }
      button {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        height: ${e.polished.rem(26)};
        svg {
          margin-right: 0;
        }
      }
    }
    .radio-con, .checkbox-con {
      color: var(--dark-800);
      font-size: ${e.polished.rem(14)};
      line-height: ${e.polished.rem(22)};
      margin: ${e.polished.rem(4)} 0 ${e.polished.rem(8)} 0;
    }
  `,{templateList:b,jimuMapView:y,selectedTemplate:O,id:S,confirmPrint:I,views:M,handleSelectedTemplateChange:C,setSelectedTemplateByIndex:E}=l,[k,A]=K((null===(n=null==O?void 0:O.layoutOptions)||void 0===n?void 0:n.titleText)||""),[R,U]=K((null==O?void 0:O.wkid)||""),[F,$]=K(null==O?void 0:O.outScale),[_,B]=K((null===(o=null==O?void 0:O.layoutOptions)||void 0===o?void 0:o.authorText)||""),[W,G]=K((null===(a=null==O?void 0:O.layoutOptions)||void 0===a?void 0:a.copyrightText)||""),[D,J]=K(null===(r=null==O?void 0:O.layoutOptions)||void 0===r?void 0:r.customTextElements),[Y,ee]=e.React.useState(null===(s=null==O?void 0:O.exportOptions)||void 0===s?void 0:s.dpi),[te,le]=e.React.useState(null===(u=null==O?void 0:O.exportOptions)||void 0===u?void 0:u.width),[ne,ie]=e.React.useState(null===(d=null==O?void 0:O.exportOptions)||void 0===d?void 0:d.height),[oe,ae]=K(!1),[re,se]=e.React.useState(null),[ue,de]=K(null),[ce,ve]=K(!1),[pe,me]=K(!1);X((()=>{var e,t,l,n,i,o,a,r,s,u,d,c,v,m;A((null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.titleText)||""),B((null===(t=null==O?void 0:O.layoutOptions)||void 0===t?void 0:t.authorText)||""),G((null===(l=null==O?void 0:O.layoutOptions)||void 0===l?void 0:l.copyrightText)||""),J(null===(n=null==O?void 0:O.layoutOptions)||void 0===n?void 0:n.customTextElements),U(null==O?void 0:O.wkid),p.current=null==O?void 0:O.wkid,$(null==O?void 0:O.outScale),ee(null===(i=null==O?void 0:O.exportOptions)||void 0===i?void 0:i.dpi),le(null===(o=null==O?void 0:O.exportOptions)||void 0===o?void 0:o.width),ie(null===(a=null==O?void 0:O.exportOptions)||void 0===a?void 0:a.height),de(T(null===(r=null==O?void 0:O.layoutOptions)||void 0===r?void 0:r.elementOverrides)),Be(oe),ve(!!(null===(s=null==O?void 0:O.layoutOptions)||void 0===s?void 0:s.legendLayers)||(null===(d=null===(u=null==O?void 0:O.layoutOptions)||void 0===u?void 0:u.legendLayers)||void 0===d?void 0:d.length)>0),me(null===(m=null===(v=null===(c=null==O?void 0:O.layoutOptions)||void 0===c?void 0:c.elementOverrides)||void 0===v?void 0:v[ue])||void 0===m?void 0:m.visible),(null==O?void 0:O.wkidLabel)?se(null==O?void 0:O.wkidLabel):h.current&&he(null==O?void 0:O.wkid).then((e=>{se(e)}))}),[O]);const he=t=>H(void 0,void 0,void 0,(function*(){if(x.current){const{getSRLabel:e}=h.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{h.current=e,x.current=!0;const{getSRLabel:l}=h.current;return Promise.resolve(l(t))}))})),xe=t=>H(void 0,void 0,void 0,(function*(){if(x.current){const{isValidWkid:e}=h.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{h.current=e,x.current=!0;const{isValidWkid:l}=h.current;return Promise.resolve(l(t))}))})),fe=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value,n=w(null==b?void 0:b.asMutable({deep:!0}),l);E(n)},ge=(e,t)=>{const l=O.setIn(e,t);C(l)},be=()=>{ge(["forceFeatureAttributes"],!(null==O?void 0:O.forceFeatureAttributes))},ye=()=>{ge(["attributionVisible"],!(null==O?void 0:O.attributionVisible))},we=e=>H(void 0,void 0,void 0,(function*(){const e=ce?null:yield N(y);ge(["layoutOptions","legendLayers"],e),ve(!ce)})),je=()=>{var e,t,l;const n=null===(l=null===(t=null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.elementOverrides)||void 0===t?void 0:t[ue])||void 0===l?void 0:l.visible;ge(["layoutOptions","elementOverrides",ue,"visible"],!n)},Oe=e=>{ge(["layoutOptions","titleText"],e)},Se=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;A(l)},Ne=e=>H(void 0,void 0,void 0,(function*(){if(!(yield xe(e))){U(p.current);const e=yield he(p.current);return se(e),!1}p.current=e;const t=yield he(e),l=O.set("wkid",e).set("wkidLabel",t);C(l)})),Ie=e=>H(void 0,void 0,void 0,(function*(){if(yield xe(e)){const t=yield he(e);se(t)}else se(v("invalidWKID"));U(e)})),Te=e=>{ge(["outScale"],e)},Me=()=>{var e;const t=null===(e=null==y?void 0:y.view)||void 0===e?void 0:e.scale;$(t),ge(["outScale"],t)},Ce=e=>{$(e)},Pe=e=>{ge(["layoutOptions","authorText"],e)},Ee=e=>{if(e<1)return!1;ee(parseInt(e))},ke=e=>{if(e<1)return!1;ge(["exportOptions","dpi"],parseInt(e))},Le=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;B(l)},Ae=e=>{ge(["layoutOptions","copyrightText"],e)},Re=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;G(l)},ze=e=>{var t;if(!e||Number(e)<1)return le(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.width),!1;ge(["exportOptions","width"],e)},Ve=e=>{le(e)},Ue=e=>{var t;if(!e||Number(e)<1)return ie(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.height),!1;ge(["exportOptions","height"],e)},Fe=e=>{ie(e)},$e=e=>{const t=e.target.value;ge(["format"],t)},_e=e=>{const t=e.target.value;ge(["layoutOptions","scalebarUnit"],t)},Be=e=>{const t=Je(),{showOutputSpatialReference:l}=t;e&&l&&!(null==O?void 0:O.wkidLabel)&&H(void 0,void 0,void 0,(function*(){const e=yield he(null==O?void 0:O.wkid);se(e)}))},We=()=>{Be(!oe),ae(!oe)},Ge=e=>{var t;if(e===i.SetMapScale){const l=null===(t=null==y?void 0:y.view)||void 0===t?void 0:t.scale;$(l),ge(["outScale"],l);const n=O.set("outScale",l).set("printExtentType",e);C(n)}else ge(["printExtentType"],e)},De=e=>{if(h.current){const{isValidWkid:t}=h.current;return t(e)}return!0},Je=()=>{const e=j(null==O?void 0:O.layout),t=(null==O?void 0:O.hasAuthorText)&&(null==O?void 0:O.enableAuthor)&&!e,l=(null==O?void 0:O.hasCopyrightText)&&(null==O?void 0:O.enableCopyright)&&!e,n=(null==O?void 0:O.hasLegend)&&(null==O?void 0:O.enableLegend)&&!e,i=Ze()&&!e;return{showLayoutOption:t||l||n||i||(null==O?void 0:O.enableScalebarUnit),showAuthor:t,showCopyright:l,showLegend:n,showCustomTextElements:i,showTitle:null==O?void 0:O.enableTitle,showFeatureAttribution:null==O?void 0:O.enableFeatureAttribution,showMapAttribution:(null==O?void 0:O.enableMapAttribution)&&e,showQuality:null==O?void 0:O.enableQuality,showMapSize:(null==O?void 0:O.enableMapSize)&&e,showMapPrintExtents:null==O?void 0:O.enableMapPrintExtents,showScalebarUnit:(null==O?void 0:O.enableScalebarUnit)&&!e,showOutputSpatialReference:null==O?void 0:O.enableOutputSpatialReference,showNorthArrow:null==O?void 0:O.enableNorthArrow}},Ze=()=>{var e,t;const l=[];return null===(e=null==O?void 0:O.customTextElementEnableList)||void 0===e||e.forEach((e=>{for(const t in e)l.push(e[t])})),(null===(t=null==l?void 0:l.filter((e=>e)))||void 0===t?void 0:t.length)>0},He=()=>{const l=[];return null==D||D.forEach(((n,i)=>{var o,a;for(const r in n){if(!(null===(a=null===(o=null==O?void 0:O.customTextElementEnableList)||void 0===o?void 0:o[i])||void 0===a?void 0:a[r]))continue;const s=(0,e.jsx)(V,{flowWrap:!0,className:"align-item-center",label:r,key:`${r}_${i}`},(0,e.jsx)(t.TextInput,{size:"sm",className:"flex-grow-1",value:n[r]||"",onAcceptValue:e=>{Qe(i,r,e)},onChange:e=>{Ke(i,r,e)},"aria-label":r}));l.push(s)}})),l},Qe=(e,t,l)=>{const n=D[e].set(t,l),i=null==D?void 0:D.asMutable({deep:!0});i.splice(e,1,n),ge(["layoutOptions","customTextElements"],i)},Ke=(t,l,n)=>{var i;const o=null===(i=null==n?void 0:n.target)||void 0===i?void 0:i.value,a=D[t].set(l,o),r=null==D?void 0:D.asMutable({deep:!0});r.splice(t,1,a),J((0,e.Immutable)(r))};return(0,e.jsx)("div",{className:"w-100 h-100",css:g},M===m.PrintTemplate&&(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column"},(0,e.jsx)("div",{className:"flex-grow-1 w-100 setting-con"},(0,e.jsx)("div",{className:"w-100 h-100"},(()=>{var l,n,i;const o=Je(),{showTitle:a}=o;return(0,e.jsx)("div",{className:"base-setting-con"},a&&(0,e.jsx)(V,{flowWrap:!0,label:v("title")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100",value:k,"aria-label":v("title"),onAcceptValue:Oe,onChange:Se})),(0,e.jsx)(V,{flowWrap:!0,label:v("template")},(0,e.jsx)(t.Select,{value:null==O?void 0:O.templateId,onChange:fe,size:"sm","aria-label":v("template")},null==b?void 0:b.map(((l,n)=>(0,e.jsx)(t.Option,{key:null==l?void 0:l.templateId,value:null==l?void 0:l.templateId,title:null==l?void 0:l.label},null==l?void 0:l.label))))),(null===(l=null==O?void 0:O.selectedFormatList)||void 0===l?void 0:l.length)>1&&(0,e.jsx)(V,{flowWrap:!0,label:v("fileFormat")},(0,e.jsx)(t.Select,{value:null===(n=null==O?void 0:O.format)||void 0===n?void 0:n.toLowerCase(),onChange:$e,size:"sm","aria-label":v("fileFormat")},null===(i=null==O?void 0:O.selectedFormatList)||void 0===i?void 0:i.map(((l,n)=>(0,e.jsx)(t.Option,{key:`format${n}`,value:l,title:l},l))))))})(),(0,e.jsx)("div",null,j(null==O?void 0:O.layout)&&(()=>{const l=Je(),{showMapSize:n}=l;return(0,e.jsx)("div",null,n&&(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)("div",{className:"flex-grow-1"},(0,e.jsx)("div",{className:"mb-1"},v("width")),(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 map-size-con",value:te,onAcceptValue:ze,onChange:Ve,showHandlers:!1,"aria-label":v("width")})),(0,e.jsx)("div",{className:"flex-grow-1 ml-2"},(0,e.jsx)("div",{className:"mb-1"},v("height")),(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 map-size-con",value:ne,onAcceptValue:Ue,onChange:Fe,showHandlers:!1,"aria-label":v("height")}))))})(),(()=>{const l=j(null==O?void 0:O.layout),n=Je(),{showLayoutOption:o,showFeatureAttribution:a,showMapAttribution:r,showQuality:s,showMapSize:u,showMapPrintExtents:d,showScalebarUnit:c,showOutputSpatialReference:p}=n,m=o||a||r||s||u||d||c||p;return(0,e.jsx)("div",null,m&&(0,e.jsx)("div",{className:"d-flex align-items-center",role:"group","aria-label":v("advance")},(0,e.jsx)("div",{className:"flex-grow-1"},v("advance")),(0,e.jsx)(t.Button,{className:"collapse-button",size:"sm",type:"tertiary",onClick:We,title:v(oe?"collapse":"expand")},oe?(0,e.jsx)(L,null):(0,e.jsx)(P,null))),oe&&(0,e.jsx)("div",null,d&&(0,e.jsx)(V,{flowWrap:!0,label:v("mapPrintingExtents")},(0,e.jsx)("div",{role:"group","aria-label":v("mapPrintingExtents")},(0,e.jsx)("div",{title:v("currentMapExtent"),className:"d-flex align-items-center radio-con mt-1 checkbox-con",onClick:()=>{Ge(i.CurrentMapExtent)}},(0,e.jsx)(t.Radio,{title:v("currentMapExtent"),checked:(null==O?void 0:O.printExtentType)===i.CurrentMapExtent,className:"mr-2"})," ",v("currentMapExtent")),(0,e.jsx)("div",{title:v("currentMapScale"),className:"d-flex align-items-center radio-con checkbox-con",onClick:()=>{Ge(i.CurrentMapScale)}},(0,e.jsx)(t.Radio,{title:v("currentMapScale"),checked:(null==O?void 0:O.printExtentType)===i.CurrentMapScale,className:"mr-2"})," ",v("currentMapScale")),(0,e.jsx)("div",{title:v("setMapScale"),className:"d-flex align-items-center radio-con checkbox-con",onClick:()=>{Ge(i.SetMapScale)}},(0,e.jsx)(t.Radio,{title:v("setMapScale"),checked:(null==O?void 0:O.printExtentType)===i.SetMapScale,className:"mr-2"})," ",v("setMapScale")),(null==O?void 0:O.printExtentType)===i.SetMapScale&&(0,e.jsx)("div",{className:"w-100 d-flex align-items-center outscale-con"},(0,e.jsx)(t.NumericInput,{size:"sm",className:"flex-grow-1 dpi-input no-right-padding",value:F,onAcceptValue:Te,onChange:Ce,showHandlers:!1,"aria-label":v("setMapScale")}),(0,e.jsx)(t.Button,{size:"sm",onClick:Me,title:v("useCurrentScale")},(0,e.jsx)(z,null))))),p&&(0,e.jsx)(V,{flowWrap:!0,label:(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:Q.sanitize(v("spatialReference",{WKID:'<a target="_blank" href="https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references.htm">WKID</a>'}))}})},(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 dpi-input no-right-padding",value:R,onAcceptValue:Ne,onChange:Ie,showHandlers:!1,"aria-label":v("spatialReference",{WKID:""}),"aria-describedby":"print-wkid-describtion"}),(0,e.jsx)("div",{id:"print-wkid-describtion",title:re,"aria-label":re,className:(0,e.classNames)("text-truncate mt-1 wkid-describtion",{"wkid-describtion-invalid":!De(Number(R))})},re)),!l&&(()=>{var l;const n=Je(),{showAuthor:i,showCopyright:o,showLegend:a,showLayoutOption:r,showFeatureAttribution:s,showQuality:u,showScalebarUnit:d,showNorthArrow:c}=n;return(0,e.jsx)("div",{role:"group","aria-label":v("LayoutOptions")},r&&(0,e.jsx)("div",{className:"mb-2"},v("LayoutOptions")),i&&(0,e.jsx)(V,{flowWrap:!0,label:v("printAuyhor")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 dpi-input",value:_,onAcceptValue:Pe,onChange:Le,"aria-label":v("printAuyhor")})),o&&(0,e.jsx)(V,{flowWrap:!0,label:v("printCopyright")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 dpi-input",value:W,onAcceptValue:Ae,onChange:Re,"aria-label":v("printCopyright")})),He(),a&&(0,e.jsx)(V,null,(0,e.jsx)("div",{title:v("includeLegend"),className:"w-100 align-items-center d-flex checkbox-con",onClick:we},(0,e.jsx)(t.Checkbox,{title:v("includeLegend"),className:"lock-item-ratio",checked:ce}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeLegend")))),c&&(0,e.jsx)(V,null,(0,e.jsx)("div",{title:v("includeNorthArrow"),className:"w-100 align-items-center d-flex checkbox-con",onClick:je},(0,e.jsx)(t.Checkbox,{title:v("includeNorthArrow"),className:"lock-item-ratio",checked:pe}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeNorthArrow")))),d&&(0,e.jsx)(V,{label:v("scaleBarUnit"),flowWrap:!1},(0,e.jsx)(t.Select,{value:null===(l=null==O?void 0:O.layoutOptions)||void 0===l?void 0:l.scalebarUnit,onChange:_e,size:"sm",className:"scalebar-unit","aria-label":v("scaleBarUnit")},function(e){return[{value:"Miles",label:e("unitsLabelMiles")},{value:"Kilometers",label:e("unitsLabelKilometers")},{value:"Meters",label:e("unitsLabelMeters")},{value:"Feet",label:e("unitsLabelFeet")}]}(v).map(((l,n)=>(0,e.jsx)(t.Option,{key:`unit${n}`,value:l.value,title:l.label},l.label))))),u&&(0,e.jsx)(V,{label:v("printQuality"),flowWrap:!0},(0,e.jsx)("div",{className:"d-flex align-items-center w-100 dpi-con"},(0,e.jsx)(t.NumericInput,{size:"sm",className:"flex-grow-1 no-right-padding",value:Y,onAcceptValue:ke,onChange:Ee,showHandlers:!1,"aria-label":v("printQuality")}),(0,e.jsx)(t.Button,{disabled:!0,size:"sm",title:"DPI"},"DPI"))),s&&(0,e.jsx)(V,null,(0,e.jsx)("div",{title:v("includeAttributes"),className:"w-100 align-items-center d-flex checkbox-con",onClick:be},(0,e.jsx)(t.Checkbox,{title:v("includeAttributes"),className:"lock-item-ratio","data-field":"mapSize",checked:null==O?void 0:O.forceFeatureAttributes}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttributes")))))})(),l&&(()=>{const l=Je(),{showFeatureAttribution:n,showMapAttribution:i,showQuality:o}=l;return(0,e.jsx)("div",null,n&&(0,e.jsx)(V,{className:"mb-1"},(0,e.jsx)("div",{title:v("includeAttributes"),className:"w-100 align-items-center mt-1 d-flex checkbox-con",onClick:be},(0,e.jsx)(t.Checkbox,{title:v("includeAttributes"),className:"lock-item-ratio","data-field":"mapSize",checked:null==O?void 0:O.forceFeatureAttributes}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttributes")))),i&&(0,e.jsx)(V,null,(0,e.jsx)("div",{title:v("includeAttribution"),className:"w-100 align-items-center d-flex checkbox-con",onClick:ye},(0,e.jsx)(t.Checkbox,{title:v("includeAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:null==O?void 0:O.attributionVisible}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttribution")))),o&&(0,e.jsx)(V,{flowWrap:!0,label:v("printQuality")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 no-right-padding",value:Y,onAcceptValue:ke,onChange:Ee,suffix:(0,e.jsx)(t.Button,{disabled:!0,size:"sm"},"DPI")})))})()))})()))),(0,e.jsx)("div",{className:"print-button-con"},(0,e.jsx)(Z,{id:S,jimuMapView:y,className:"w-100",scale:F,selectedTemplate:O,scalebarUnit:null===(c=null==O?void 0:O.layoutOptions)||void 0===c?void 0:c.scalebarUnit,printExtentType:null==O?void 0:O.printExtentType}),(0,e.jsx)(t.Button,{className:"w-100 mt-2",type:"primary",onClick:()=>{I(O)}},v("_widgetLabel")))))};var ee=o(55339),te=o.n(ee);const le=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:te()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var ne=o(51513),ie=o.n(ne);const oe=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:ie()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var ae=o(94539),re=o.n(ae);const se=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:re()},i)):e.React.createElement("svg",Object.assign({className:o},i))},ue=l=>{const n=e.hooks.useTranslation(f,t.defaultMessages),i=e.css`
    & {
      overflow: auto;
      padding: ${e.polished.rem(16)} ${e.polished.rem(16)} ${e.polished.rem(16)} ${e.polished.rem(16)};
    }
    button {
      padding-left: 0;
      padding-right: 0;
    }
    a {
      padding: 0;
    }
    .print-loading-con {
      @keyframes loading {
        0% {transform: rotate(0deg); };
        100% {transform: rotate(360deg)};
      }
      width: ${e.polished.rem(16)};
      height: ${e.polished.rem(16)};
      border: 1px solid var(--dark-100);
      border-radius: 50%;
      border-top: 1px solid var(--dark-800);
      box-sizing: border-box;
      animation:loading 2s infinite linear;
      margin-right: ${e.polished.rem(4)};
    }
    .error-link, .error-link:hover {
      color: var(--dark);
      & svg {
        color: var(--danger-800);
      }
    }
  `,{printResultList:o,deleteResultItem:a}=l;return(0,e.jsx)("div",{className:"w-100 h-100",css:i},0===(null==o?void 0:o.length)&&(0,e.jsx)("div",null,n("resultEmptyMessage")),o.map(((l,i)=>(0,e.jsx)("div",{className:"d-flex align-items-center mb-2 w-100",key:null==l?void 0:l.resultId},(0,e.jsx)(t.Button,{href:null==l?void 0:l.url,disabled:!(null==l?void 0:l.url),target:"_blank",size:"sm","aria-label":null==l?void 0:l.title,title:(null==l?void 0:l.state)!==p.Error?null==l?void 0:l.title:"",type:"tertiary",className:(0,e.classNames)("flex-grow-1 d-flex align-items-center",{"error-link":(null==l?void 0:l.state)===p.Error})},(t=>{switch(t.state){case p.Loading:return(0,e.jsx)("div",{className:"print-loading-con"});case p.Success:return(0,e.jsx)(oe,null);case p.Error:return(0,e.jsx)("span",{title:n("uploadImageError")},(0,e.jsx)(se,null))}})(l),(0,e.jsx)("div",{className:"ml-2",title:(null==l?void 0:l.state)===p.Error?null==l?void 0:l.title:""},null==l?void 0:l.title)),(0,e.jsx)(t.Button,{size:"sm",type:"tertiary",onClick:()=>{a(i)},title:n("remove")},(0,e.jsx)(le,null))))))};const de=e=>{return t=void 0,n=void 0,o=function*(){const{mapView:t,printTemplateProperties:n,useUtility:i}=e;return S(i).then((e=>(0,l.loadArcGISJSAPIModules)(["esri/rest/support/PrintParameters","esri/rest/support/PrintTemplate","esri/rest/print","esri/geometry/SpatialReference"]).then((l=>{var i;const[o,a,r,s]=l,u=new a(n),d=function(e){var t,l;return e.layerViews.items=null===(l=null===(t=null==e?void 0:e.layerViews)||void 0===t?void 0:t.items)||void 0===l?void 0:l.map((e=>{var t,l,n,i,o,a,r;return(null===(l=null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.id)||void 0===l?void 0:l.includes("jimu-draw-layer-"))||(null===(i=null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.id)||void 0===i?void 0:i.includes("bookmark-layer-"))?(e.graphicsView.graphics.items=null===(r=null===(a=null===(o=null==e?void 0:e.graphicsView)||void 0===o?void 0:o.graphics)||void 0===a?void 0:a.items)||void 0===r?void 0:r.map((e=>{var t;return(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t.jimuDrawId)?(e.geometry.hasZ=!1,e):e})),e):e})),e}(t),c={view:d,template:u};n.wkid!==(null===(i=null==t?void 0:t.spatialReference)||void 0===i?void 0:i.wkid)&&(c.outSpatialReference=new s({wkid:n.wkid}));const v=new o(c);return r.execute(e,v).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))}))))},new((i=void 0)||(i=Promise))((function(e,l){function a(e){try{s(o.next(e))}catch(e){l(e)}}function r(e){try{s(o.throw(e))}catch(e){l(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof i?l:new i((function(e){e(l)}))).then(a,r)}s((o=o.apply(t,n||[])).next())}));var t,n,i,o};const{useState:ce,useRef:ve,useEffect:pe}=e.React,me=l=>{const n=e.hooks.useTranslation(f,t.defaultMessages),i=ve([]),o=ve([]),a=ve(null),r=e.css`
    .classic-setting-con {
      height: 0;
    }
    .nav-bar-con {
      height: ${e.polished.rem(40)};
      border: none !important;
      border-bottom: 1px solid var(--light-200) !important;
      padding: 0;
      .navbar-nav button.nav-link, .navbar-nav button.nav-link:hover, .navbar-nav button.nav-link:focus {
        color: var(--dark-800);
      }
      .jimu-nav-link-wrapper .jimu-badge-wrapper {
        & {
          display: block;
        }
        .badge-dot {
          top: ${e.polished.rem(4)};
          right: ${e.polished.rem(4)};
        }
      }
    }
  `,{config:s,jimuMapView:u,templateList:d,id:c,locale:v}=l,[h,x]=ce(m.PrintTemplate),[g,b]=ce((0,e.Immutable)([])),[j,S]=ce(null);pe((()=>{C(0)}),[]),pe((()=>{var t;if(j&&O(d,null==j?void 0:j.templateId)){const l=w(null==d?void 0:d.asMutable({deep:!0}),null==j?void 0:j.templateId),n=null===(t=P(null==d?void 0:d[l]))||void 0===t?void 0:t.asMutable({deep:!0});N(n),a.current=(0,e.Immutable)(n)}j&&O(d,null==j?void 0:j.templateId)||C(0)}),[d,s]);const N=t=>{var l;let n=null==j?void 0:j.asMutable({deep:!0});for(const e in n)e.includes("enable")&&delete n[e];const i=I(t,null===(l=a.current)||void 0===l?void 0:l.asMutable({deep:!0}));(null==i?void 0:i.length)>0&&i.forEach((l=>{var i;let o=t;l.forEach((e=>{o=o[e]})),n=null===(i=(0,e.Immutable)(n).setIn(l,o))||void 0===i?void 0:i.asMutable({deep:!0})})),n.customTextElementEnableList=null==t?void 0:t.customTextElementEnableList,n.selectedFormatList=null==t?void 0:t.selectedFormatList;const o=(0,e.Immutable)(Object.assign(Object.assign({},t),n));E(o)},I=(e,t)=>{const l=T(e,t);return M(l)},T=(e,t)=>{var l,n,i;if(!e||!t)return null;const o=[];for(const a in e){const r=e[a]instanceof Object;if(Array.isArray(e[a]))if(Array.isArray(t[a])&&(null===(l=e[a])||void 0===l?void 0:l.length)===(null===(n=null==t?void 0:t[a])||void 0===n?void 0:n.length)){const l=null===(i=e[a])||void 0===i?void 0:i.filter((e=>{var l;return!(null===(l=null==t?void 0:t[a])||void 0===l?void 0:l.includes(e))}));(null==l?void 0:l.length)>0&&o.push(a)}else o.push(a);else if(r){const l={},n=T(e[a],null==t?void 0:t[a]);l[a]=n,(null==n?void 0:n.length)>0&&o.push(l)}else(null==e?void 0:e[a])!==(null==t?void 0:t[a])&&o.push(a)}return o},M=(e,t)=>{let l=[];return null==e||e.forEach((n=>{const i=n instanceof Object,o=Array.isArray(n);let a=t||[];if(o)l=M(e,a);else if(i)Object.keys(n).forEach((e=>{a.push(e),a=M(n[e],a)})),l=a;else{const e=a.concat([n]);l.push(e)}})),l},C=e=>{if(0===(null==d?void 0:d.length))return!1;const t=P(null==d?void 0:d[e]);a.current=t,E(t)},P=t=>t?t=(null==t?void 0:t.overrideCommonSetting)?y((0,e.Immutable)(null==s?void 0:s.commonSetting),(0,e.Immutable)(t)):y((0,e.Immutable)(t),(0,e.Immutable)(null==s?void 0:s.commonSetting)):null,E=e=>{S(e)},k=t=>{x(t),t===m.PrintResult&&(o.current=(0,e.Immutable)(i.current).asMutable())},L=e=>{const t=_(c,u.id),l=u.view.map.findLayerById(t);l&&(l.visible=e)},A=(t,l,n)=>{let o;n&&(t.url=n),t.state=l;const a=i.current;a.forEach(((e,l)=>{e.resultId===t.resultId&&(o=l)})),(o||0===o)&&(a.splice(o,1,t),b((0,e.Immutable)(a)),i.current=a)};return(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column",css:r},(0,e.jsx)(t.Navbar,{className:"nav-bar-con w-100",border:!1,color:"false",light:!0},(0,e.jsx)(t.Nav,{className:"w-100 h-100",underline:!0,navbar:!0,justified:!0,fill:!0},(0,e.jsx)(t.NavItem,{title:n("printTemplate"),onClick:()=>{k(m.PrintTemplate)},className:"link-con"},(0,e.jsx)(t.NavLink,{tag:"button",active:h===m.PrintTemplate},n("printTemplate"))),(0,e.jsx)(t.NavItem,{title:n("printResult"),onClick:()=>{k(m.PrintResult)}},(0,e.jsx)(t.NavLink,{tag:"button",active:h===m.PrintResult},(0,e.jsx)(t.Badge,{className:"w-100 h-100",dot:!0,color:"primary",hideBadge:(null===(R=null==i?void 0:i.current)||void 0===R?void 0:R.length)===(null===(z=null==o?void 0:o.current)||void 0===z?void 0:z.length)},n("printResult")))))),(0,e.jsx)("div",{className:"flex-grow-1 w-100 classic-setting-con overflow-hidden"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"sr-only":h!==m.PrintTemplate})},(0,e.jsx)(Y,{id:c,config:s,jimuMapView:u,selectedTemplate:j,templateList:d,confirmPrint:t=>{return l=void 0,n=void 0,a=function*(){var l;const n={resultId:F((0,e.Immutable)(i.current)),url:null,title:U(null===(l=null==t?void 0:t.layoutOptions)||void 0===l?void 0:l.titleText,(0,e.Immutable)(i.current)),state:p.Loading},o=i.current;o.push(n),i.current=o,b((0,e.Immutable)(o)),L(!1),de({useUtility:null==s?void 0:s.useUtility,mapView:null==u?void 0:u.view,printTemplateProperties:yield B(t,u,v)}).then((e=>{L(!0),A(n,p.Success,null==e?void 0:e.url)}),(e=>{L(!0),A(n,p.Error)}))},new((o=void 0)||(o=Promise))((function(e,t){function i(e){try{s(a.next(e))}catch(e){t(e)}}function r(e){try{s(a.throw(e))}catch(e){t(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof o?l:new o((function(e){e(l)}))).then(i,r)}s((a=a.apply(l,n||[])).next())}));var l,n,o,a},views:h,handleSelectedTemplateChange:E,setSelectedTemplateByIndex:C})),h===m.PrintResult&&(0,e.jsx)(ue,{config:s,printResultList:g,deleteResultItem:t=>{var l,n;const a=i.current;a.splice(t,1),b((0,e.Immutable)(a)),i.current=null===(l=(0,e.Immutable)(a))||void 0===l?void 0:l.asMutable({deep:!0}),o.current=null===(n=(0,e.Immutable)(a))||void 0===n?void 0:n.asMutable({deep:!0})}})));var R,z};const he=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:x()},i)):e.React.createElement("svg",Object.assign({className:o},i))},xe=t=>{const l=e.css`
    &.print-loading-con {
      @keyframes loading {
        0% {transform: rotate(0deg); };
        100% {transform: rotate(360deg)};
      }
      width: ${e.polished.rem(16)};
      height: ${e.polished.rem(16)};
      border: 1px solid var(--dark-100);
      border-radius: 50%;
      border-top: 1px solid var(--dark-800);
      box-sizing: border-box;
      animation:loading 2s infinite linear;
      margin-right: ${e.polished.rem(4)};
    }
  `;return(0,e.jsx)("div",{css:l,className:"print-loading-con"})},fe=l=>{const n=e.hooks.useTranslation(f,t.defaultMessages),{prinResult:i,restPrint:o}=l,a=e.css`
    .error-link, .error-link:hover {
      color: var(--dark);
      & svg {
        color: var(--danger-800);
      }
    }
  `;return(0,e.jsx)("div",{className:"d-flex flex-column h-100 w-100",css:a},(0,e.jsx)(t.Button,{href:null==i?void 0:i.url,disabled:!(null==i?void 0:i.url),target:"_blank",size:"sm","aria-label":null==i?void 0:i.title,title:null==i?void 0:i.title,type:"tertiary",className:(0,e.classNames)("d-flex align-items-center",{"error-link":(null==i?void 0:i.state)===p.Error})},(()=>{switch(null==i?void 0:i.state){case p.Loading:return(0,e.jsx)(xe,null);case p.Success:return(0,e.jsx)(oe,null);case p.Error:return(0,e.jsx)("span",{title:n("uploadImageError")},(0,e.jsx)(se,null))}})(),(0,e.jsx)("div",{className:"ml-2"},null==i?void 0:i.title)),(0,e.jsx)("div",{className:"flex-grow-1 d-flex align-items-end"},(0,e.jsx)("div",{className:"flex-grow-1"}),(0,e.jsx)(t.Button,{type:"primary",onClick:o},n("reset"))))};const{useState:ge,useRef:be,useEffect:ye}=e.React,{useSelector:we}=e.ReactRedux,je=l=>{var n,i;const{config:o,templateList:a,jimuMapView:r,errorTip:s,id:u,locale:d}=l,c=e.hooks.useTranslation(f,t.defaultMessages),v=be(null),m=we((e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.appConfig)||void 0===t?void 0:t.widgets)||void 0===l?void 0:l[u]})),h=e.css`
    .compact-con {
      padding: 0;
      svg {
        margin: 0 auto;
      }
      .compact-icon {
        color: ${null===(i=null===(n=null==m?void 0:m.icon)||void 0===n?void 0:n.properties)||void 0===i?void 0:i.color};
      }
    }
  `,x=e.css`
    & {
      padding: ${e.polished.rem(12)};
      width: ${e.polished.rem(320)};
      height: ${e.polished.rem(155)};
    }
    .close-con button{
      padding: 0;
    }
    .result-list-con button {
      padding: 0;
    }
    .compact-preview-con {
      width: 0;
    }
  `,g=[{name:"preventOverflow",options:{altAxis:!0}},(0,t.getFallbackPlacementsModifier)(["left-start","left-end"],!0)],[b,j]=ge(!1),[S,N]=ge(!1),[I,T]=ge(null),[M,C]=ge(null);ye((()=>{P(0)}),[]),ye((()=>{if(M&&O(a,null==M?void 0:M.templateId)||P(0),M&&O(a,null==M?void 0:M.templateId)){const e=w(null==a?void 0:a.asMutable({deep:!0}),null==M?void 0:M.templateId);P(e)}}),[a,o]);const P=e=>{if(0===(null==a?void 0:a.length))return!1;let t=null==a?void 0:a[e];t=(null==t?void 0:t.overrideCommonSetting)?y(null==o?void 0:o.commonSetting,t):y(t,null==o?void 0:o.commonSetting),C(t)},E=(e,t)=>{j("clickOutside"!==t&&!b)},k=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value,n=w(null==a?void 0:a.asMutable({deep:!0}),l);P(n)},L=e=>{const t=_(u,r.id),l=r.view.map.findLayerById(t);l&&(l.visible=e)},A=()=>{return t=void 0,l=void 0,i=function*(){var t;const l={resultId:null==M?void 0:M.templateId,url:null,title:null===(t=null==M?void 0:M.layoutOptions)||void 0===t?void 0:t.titleText,state:p.Loading};T((0,e.Immutable)(l)),N(!S),L(!1),de({useUtility:null==o?void 0:o.useUtility,mapView:null==r?void 0:r.view,printTemplateProperties:yield B(M,r,d)}).then((t=>{l.url=null==t?void 0:t.url,l.state=p.Success,L(!0),T((0,e.Immutable)(l))}),(t=>{L(!0),l.state=p.Error,T((0,e.Immutable)(l))}))},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(a,r)}s((i=i.apply(t,l||[])).next())}));var t,l,n,i},R=()=>!r||!(null==o?void 0:o.useUtility);return(0,e.jsx)("div",{className:"w-100 h-100",css:h},(0,e.jsx)(t.Button,{className:"w-100 h-100 compact-con",type:"tertiary",ref:v,title:c("_widgetLabel"),onClick:E},(()=>{const l=null==m?void 0:m.icon;return l?"string"==typeof l?(0,e.jsx)(t.SVG,{src:l}):(0,e.jsx)(t.Icon,{className:"compact-icon",icon:null==l?void 0:l.svg}):(0,e.jsx)(he,null)})()),(0,e.jsx)(t.Popper,{open:b,disableResize:!0,placement:"bottom",reference:v,modifiers:g,showArrow:!0,toggle:E,trapFocus:!1,autoFocus:!1,css:x},!R()&&(0,e.jsx)("div",{className:"d-flex flex-column w-100 h-100"},(0,e.jsx)("div",{className:"text-right close-con"},(0,e.jsx)(t.Button,{className:"print-button",type:"tertiary",title:c("closeTour"),onClick:E},(0,e.jsx)(le,null))),(0,e.jsx)("div",{className:"flex-grow-1"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"sr-only":S})},(()=>{var l;return(0,e.jsx)("div",{className:"d-flex flex-column"},(0,e.jsx)(V,{flowWrap:!0,className:"flex-grow-1",label:c("template")},(0,e.jsx)(t.Select,{value:null==M?void 0:M.templateId,onChange:k,size:"sm",className:"scalebar-unit","aria-label":c("template")},null==a?void 0:a.map(((l,n)=>(0,e.jsx)(t.Option,{key:l.templateId,value:l.templateId,title:l.label},l.label))))),(0,e.jsx)("div",{className:"print-button-con d-flex align-items-center mt-2"},(0,e.jsx)(Z,{className:"flex-grow-1 compact-preview-con",id:u,jimuMapView:r,scale:null==M?void 0:M.outScale,selectedTemplate:M,scalebarUnit:null===(l=null==M?void 0:M.layoutOptions)||void 0===l?void 0:l.scalebarUnit,printExtentType:null==M?void 0:M.printExtentType}),(0,e.jsx)(t.Button,{className:"print-button text-truncate ml-1",type:"primary",onClick:A,title:c("_widgetLabel")},c("_widgetLabel"))))})()),S&&(0,e.jsx)(fe,{prinResult:I,restPrint:()=>{T(null),N(!1)}}))),R()&&(0,e.jsx)("div",null,s)))};function Oe(t){const l={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[n]=e;return n(t,l).then((e=>function(e){return t=this,l=void 0,i=function*(){let t=!1,l=!1;const n=(null==e?void 0:e.parameters)||[];let i=[],o=[],a="png32";return null==n||n.forEach((e=>{var n,r;if("Layout_Template"===e.name){const t=e.choiceList,l=e.defaultValue;t?i=null==t?void 0:t.map((e=>Se(e))):i.push(Se(l))}if("Format"===e.name){const t=null===(n=null==e?void 0:e.choiceList)||void 0===n?void 0:n.map((e=>null==e?void 0:e.toLowerCase()));a=null===(r=e.defaultValue)||void 0===r?void 0:r.toLowerCase(),o=t||[a]}"string"==typeof e.name&&"web_map_as_json"===e.name.toLowerCase()&&(t=!0),"string"==typeof e.name&&"output_file"===e.name.toLowerCase()&&(l=!0)})),Promise.resolve({templates:i,formatList:o,defaultFormat:a,hasWebmapParam:t,hasOutputParam:l})},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(a,r)}s((i=i.apply(t,l||[])).next())}));var t,l,n,i}(null==e?void 0:e.data)))}))}function Se(e){const t=j(e)?{}:{layoutOptions:{legend:!1}};return Object.assign({label:e,layout:e,format:"PNG32"},t)}const Ne=(t,l,n)=>{const i=Ce(null==l?void 0:l.utilityId);return Oe(t).then((o=>{let a=n;const r=(null==o?void 0:o.templates)?((t,l,n)=>((e,t,l)=>{const n=((e,t)=>e===c.Customize||t===v.Customize?"custom":"org")(t,l);return e.map(((e,t)=>(e.templateId=`config_${n}_${t}`,e)))})(t.map((t=>{var l;let n=(0,e.Immutable)(t);return n=n.set("layout",null==t?void 0:t.layout),n=n.setIn(["layoutOptions","scalebarUnit"],"Miles").setIn(["layoutOptions","legendLayers"],null),j(null==n?void 0:n.layout)&&(n=n.set("exportOptions",Object.assign({width:800,height:1100},null==t?void 0:t.exportOptions))),null===(l=y((0,e.Immutable)(u),(0,e.Immutable)(n)))||void 0===l?void 0:l.asMutable({deep:!0})})),l,n))(null==o?void 0:o.templates,i,null==n?void 0:n.printTemplateType):[],s=null==r?void 0:r.map((e=>{var t;return(null==e?void 0:e.layout)&&(e.layout=null==e?void 0:e.layout),(null==e?void 0:e.format)&&(e.format=null===(t=null==e?void 0:e.format)||void 0===t?void 0:t.toLowerCase()),e}));return function(t){const l={query:{"env:outSR":"","env:processSR":"",returnZ:!1,returnM:!1,returnTrueCurves:!1,returnFeatureCollection:!1,context:"",f:"json"},responseType:"json"};return function(t){var l;if(!t)return Promise.resolve(null);const n=`${null===(l=t.split("/GPServer"))||void 0===l?void 0:l[0]}/GPServer`,i={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(n,i).then((e=>{var t,l;const i=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.tasks,o=null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.executionType,a=o===g.SynchronousExecute?"execute":"submitJob";let r=null,s=null;return null==i||i.forEach((e=>{(null==e?void 0:e.includes("Templates"))&&(r=`${n}/${e}`,s=`${n}/${e}/${a}`)})),Promise.resolve({templatesInfoTaskUrl:r,url:s,executionType:o})}))}))}(t).then((t=>{const{url:n,executionType:i,templatesInfoTaskUrl:o}=t;return n?(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(n,l).then((e=>{var n,a,r;if(i===g.AsynchronousSubmit){const i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.jobId;return t(`${o}/jobs/${i}/results/Output_JSON`,l).then((e=>{var t;return Promise.resolve((null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.value)||[])}))}return Promise.resolve((null===(r=null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.results[0])||void 0===r?void 0:r.value)||[])}))})):Promise.resolve(null)}))}(t).then((e=>{const t=Ie(e,s),n=Me(null==o?void 0:o.templates,t);return a=a.set("printCustomTemplate",t).set("useUtility",l).set("formatList",null==o?void 0:o.formatList).set("defaultFormat",null==o?void 0:o.defaultFormat).set("layoutChoiceList",n),Promise.resolve(a)}))}))},Ie=(e,t)=>null==t?void 0:t.map((t=>{var l,n,i,o,a,r,u;let d;e&&0!==(null==e?void 0:e.length)?e.forEach((e=>{t.label===e.layoutTemplate&&(d=e)})):d=s,(null==d?void 0:d.webMapFrameSize)&&(t.mapFrameSize=null==d?void 0:d.webMapFrameSize,t.mapFrameUnit=null==d?void 0:d.pageUnits);const c=null===(n=null===(l=null==d?void 0:d.layoutOptions)||void 0===l?void 0:l.customTextElements)||void 0===n?void 0:n.map((e=>{const t={};for(const l in e)t[l]=!0;return t})),v=Te(null==d?void 0:d.layoutOptions);return t.mapFrameUnit=null==d?void 0:d.pageUnits,t.hasAuthorText=null===(i=null==d?void 0:d.layoutOptions)||void 0===i?void 0:i.hasAuthorText,t.hasCopyrightText=null===(o=null==d?void 0:d.layoutOptions)||void 0===o?void 0:o.hasCopyrightText,t.hasLegend=null===(a=null==d?void 0:d.layoutOptions)||void 0===a?void 0:a.hasLegend,t.hasTitleText=null===(r=null==d?void 0:d.layoutOptions)||void 0===r?void 0:r.hasTitleText,t.selectedFormatList=[null==t?void 0:t.format],t.layoutOptions.customTextElements=(null===(u=null==d?void 0:d.layoutOptions)||void 0===u?void 0:u.customTextElements)||[],t.layoutOptions.elementOverrides=v,t.customTextElementEnableList=c||[],t.enableNorthArrow=!!T(v),t})),Te=e=>{const t=(null==e?void 0:e.mapSurroundInfos)||[],l=null==t?void 0:t.find((e=>e.type===`${n}`)),i={};return l&&(i[null==l?void 0:l.name]=l),(null==e?void 0:e.elementOverrides)||i},Me=(e,t)=>(null==e?void 0:e.map((e=>(e.layoutTemplate=null==e?void 0:e.layout,null==t||t.forEach((t=>{(null==e?void 0:e.layout)===(null==t?void 0:t.layout)&&(e.mapFrameSize=null==t?void 0:t.mapFrameSize,e.mapFrameUnit=null==t?void 0:t.mapFrameUnit,e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText)})),e))))||[],Ce=t=>{const l=e.UtilityManager.getInstance().getUtilityJson(t);return"org"===(null==l?void 0:l.source)?c.OrganizationService:c.Customize};class Pe extends e.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.10.0",description:"update layoutChoiceList of old print widget",upgrader:t=>{return l=this,n=void 0,o=function*(){const l=null==t?void 0:t.useUtility,n=t=>{var l,n,i,o,a,r;let s=(0,e.Immutable)(t);if(null===(l=null==t?void 0:t.exportOptions)||void 0===l?void 0:l.dpi){const e=Number(null===(n=null==t?void 0:t.exportOptions)||void 0===n?void 0:n.dpi);e<0?s=s.setIn(["exportOptions","dpi"],1):parseInt(e)!==e&&(s=s.setIn(["exportOptions","dpi"],parseInt(e)))}return(null===(i=null==t?void 0:t.exportOptions)||void 0===i?void 0:i.width)?Number(null===(o=null==t?void 0:t.exportOptions)||void 0===o?void 0:o.width)<1&&(s=s.setIn(["exportOptions","width"],800)):(null==t?void 0:t.layout)&&j(null==t?void 0:t.layout)&&(s=s.setIn(["exportOptions","width"],800)),(null===(a=null==t?void 0:t.exportOptions)||void 0===a?void 0:a.height)?Number(null===(r=null==t?void 0:t.exportOptions)||void 0===r?void 0:r.height)<1&&(s=s.setIn(["exportOptions","height"],1100)):(null==t?void 0:t.layout)&&j(null==t?void 0:t.layout)&&(s=s.setIn(["exportOptions","height"],1100)),null==s?void 0:s.asMutable({deep:!0})};if(t=(e=>{var t,l;return(null===(l=null===(t=null==e?void 0:e.commonSetting)||void 0===t?void 0:t.exportOptions)||void 0===l?void 0:l.dpi)?e.setIn(["commonSetting"],n(e.commonSetting)):e})(t),l){const e=yield(s=l,u=t,i=void 0,o=void 0,a=void 0,r=function*(){return S(s).then((e=>Ne(e,s,u)))},new(a||(a=Promise))((function(e,t){function l(e){try{s(r.next(e))}catch(e){t(e)}}function n(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(l,n)}s((r=r.apply(i,o||[])).next())})));if(null==e?void 0:e.layoutChoiceList){const l=((e,t)=>{var l;const i=(null===(l=null==e?void 0:e.printCustomTemplate)||void 0===l?void 0:l.asMutable({deep:!0}))||[];return i?null==i?void 0:i.map((e=>{var l;if(null==e?void 0:e.mapFrameSize)return n(e);{const i=null===(l=null==t?void 0:t.filter((t=>(null==t?void 0:t.layout)===(null==e?void 0:e.layout))))||void 0===l?void 0:l[0],o={mapFrameSize:null==i?void 0:i.mapFrameSize,mapFrameUnit:null==i?void 0:i.mapFrameUnit,hasAuthorText:null==i?void 0:i.hasAuthorText,hasCopyrightText:null==i?void 0:i.hasCopyrightText,hasLegend:null==i?void 0:i.hasLegend,hasTitleText:null==i?void 0:i.hasTitleText};return Object.assign(Object.assign({},n(e)),o)}})):i})(t,null==e?void 0:e.layoutChoiceList);return t.setIn(["layoutChoiceList"],null==e?void 0:e.layoutChoiceList).set("printCustomTemplate",l)}return t}var i,o,a,r,s,u;return t},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof i?l:new i((function(e){e(l)}))).then(a,r)}s((o=o.apply(l,n||[])).next())}));var l,n,i,o}}]}}const Ee=new Pe,{useState:ke,useRef:Le,useEffect:Ae}=e.React,Re=n=>{const{id:i,config:o,dispatch:a,useMapWidgetIds:r,layoutId:s,layoutItemId:u,locale:p}=n,m=e.hooks.useTranslation(f,t.defaultMessages),h=e.ReactRedux.useSelector((e=>{var t;const l=null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.selection;return!(!l||l.layoutId!==s||l.layoutItemId!==u)})),g=Le(!1),b=e.css`
    .jimu-widget-placeholder {
      border: none;
    }
    &.surface-1 {
      border: none !important;
    }
    .checkbox-con:hover {
      color: var(--dark-800);
    }
  `;Ae((()=>{T()}),[h]),Ae((()=>{I()}),[o]);const[y,w]=ke(null),[j,O]=ke(m("printPleaceholder")),[S,N]=ke(null),I=()=>{var e,t;const l=(e=null==o?void 0:o.printServiceType,t=null==o?void 0:o.printTemplateType,e===c.Customize||t===v.Customize?null==o?void 0:o.printCustomTemplate:null==o?void 0:o.printOrgTemplate);N(l)},T=()=>{s&&i&&u&&!g.current&&h&&(a(e.appActions.widgetStatePropChange(i,"layoutInfo",{layoutId:s,layoutItemId:u})),g.current=!0)},M=()=>{let e=j;return y&&!(null==o?void 0:o.useUtility)&&(e=""),e},C=()=>!y||!(null==o?void 0:o.useUtility);return(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"surface-1":(null==o?void 0:o.modeType)===d.Classic}),css:b},(0,e.jsx)("div",{className:"map"},(0,e.jsx)("div",null,(0,e.jsx)(l.JimuMapViewComponent,{useMapWidgetId:null==r?void 0:r[0],onActiveViewChange:e=>null==e||"2d"!==e.view.type?(O(m("chooseMapTip")),void w(null)):(r&&0!==(null==r?void 0:r.length)||O(m("printPleaceholder")),void w(e)),onViewGroupCreate:e=>{}}))),(null==o?void 0:o.modeType)===d.Classic&&(0,e.jsx)("div",{className:"w-100 h-100"},!C()&&(0,e.jsx)(me,{id:i,locale:p,config:o,jimuMapView:y,templateList:S}),C()&&(0,e.jsx)(t.WidgetPlaceholder,{icon:x(),widgetId:i,message:M()})),(null==o?void 0:o.modeType)===d.Compact&&(0,e.jsx)("div",{className:"w-100 h-100"},(0,e.jsx)(je,{id:i,config:o,locale:p,jimuMapView:y,templateList:S,errorTip:M()})))};Re.versionManager=Ee;const ze=Re;function Ve(e){o.p=e}})(),a})())}}}));